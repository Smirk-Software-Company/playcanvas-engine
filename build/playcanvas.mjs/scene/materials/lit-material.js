import { ShaderProcessorOptions } from '../../platform/graphics/shader-processor-options.js';
import { SPECULAR_BLINN, SPECOCC_AO, FRESNEL_SCHLICK } from '../constants.js';
import { Material } from './material.js';
import { LitMaterialOptions } from './lit-material-options.js';
import { LitMaterialOptionsBuilder } from './lit-material-options-builder.js';
import { getProgramLibrary } from '../shader-lib/get-program-library.js';
import { lit } from '../shader-lib/programs/lit.js';

const options = new LitMaterialOptions();

/**
 * LitMaterial comprises a shader chunk implementing the material "front end" (the shader program
 * providing the material surface properties like diffuse, opacity, normals etc) and a set of
 * flags which control the material "back end" (the shader program calculating the lighting,
 * shadows, reflections, fogging etc).
 *
 * The front end and back end together form a complete PBR shader.
 *
 * @ignore
 */
class LitMaterial extends Material {
  constructor(...args) {
    super(...args);
    this.usedUvs = [true];
    this.shaderChunk = 'void evaluateFrontend() {}\n';
    this.chunks = null;
    this.useLighting = true;
    this.useFog = true;
    this.useGammaTonemap = true;
    this.useSkybox = true;
    this.shadingModel = SPECULAR_BLINN;
    this.ambientSH = null;
    this.pixelSnap = false;
    this.nineSlicedMode = null;
    this.fastTbn = false;
    this.twoSidedLighting = false;
    this.occludeDirect = false;
    this.occludeSpecular = SPECOCC_AO;
    this.occludeSpecularIntensity = 1;
    this.opacityFadesSpecular = true;
    this.conserveEnergy = true;
    this.ggxSpecular = false;
    this.fresnelModel = FRESNEL_SCHLICK;
    this.dynamicRefraction = false;
    // has members
    this.hasAo = false;
    this.hasSpecular = false;
    this.hasSpecularityFactor = false;
    this.hasLighting = false;
    this.hasHeights = false;
    this.hasNormals = false;
    this.hasSheen = false;
    this.hasRefraction = false;
    this.hasIrridescence = false;
    this.hasMetalness = false;
    this.hasClearCoat = false;
    this.hasClearCoatNormals = false;
  }
  getShaderVariant(device, scene, objDefs, unused, pass, sortedLights, viewUniformFormat, viewBindGroupFormat, vertexFormat) {
    options.usedUvs = this.usedUvs.slice();
    options.shaderChunk = this.shaderChunk;
    LitMaterialOptionsBuilder.update(options.litOptions, this, scene, objDefs, pass, sortedLights);
    const processingOptions = new ShaderProcessorOptions(viewUniformFormat, viewBindGroupFormat, vertexFormat);
    const library = getProgramLibrary(device);
    library.register('lit', lit);
    const shader = library.getProgram('lit', options, processingOptions, this.userId);
    return shader;
  }
}

export { LitMaterial };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl0LW1hdGVyaWFsLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvc2NlbmUvbWF0ZXJpYWxzL2xpdC1tYXRlcmlhbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaGFkZXJQcm9jZXNzb3JPcHRpb25zIH0gZnJvbSAnLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3Mvc2hhZGVyLXByb2Nlc3Nvci1vcHRpb25zLmpzJztcbmltcG9ydCB7IEZSRVNORUxfU0NITElDSywgU1BFQ09DQ19BTywgU1BFQ1VMQVJfQkxJTk4gfSBmcm9tIFwiLi4vY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgeyBNYXRlcmlhbCB9IGZyb20gJy4vbWF0ZXJpYWwuanMnO1xuaW1wb3J0IHsgTGl0TWF0ZXJpYWxPcHRpb25zIH0gZnJvbSAnLi9saXQtbWF0ZXJpYWwtb3B0aW9ucy5qcyc7XG5pbXBvcnQgeyBMaXRNYXRlcmlhbE9wdGlvbnNCdWlsZGVyIH0gZnJvbSAnLi9saXQtbWF0ZXJpYWwtb3B0aW9ucy1idWlsZGVyLmpzJztcbmltcG9ydCB7IGdldFByb2dyYW1MaWJyYXJ5IH0gZnJvbSBcIi4uL3NoYWRlci1saWIvZ2V0LXByb2dyYW0tbGlicmFyeS5qc1wiO1xuaW1wb3J0IHsgbGl0IH0gZnJvbSAnLi4vc2hhZGVyLWxpYi9wcm9ncmFtcy9saXQuanMnO1xuXG5jb25zdCBvcHRpb25zID0gbmV3IExpdE1hdGVyaWFsT3B0aW9ucygpO1xuXG4vKipcbiAqIExpdE1hdGVyaWFsIGNvbXByaXNlcyBhIHNoYWRlciBjaHVuayBpbXBsZW1lbnRpbmcgdGhlIG1hdGVyaWFsIFwiZnJvbnQgZW5kXCIgKHRoZSBzaGFkZXIgcHJvZ3JhbVxuICogcHJvdmlkaW5nIHRoZSBtYXRlcmlhbCBzdXJmYWNlIHByb3BlcnRpZXMgbGlrZSBkaWZmdXNlLCBvcGFjaXR5LCBub3JtYWxzIGV0YykgYW5kIGEgc2V0IG9mXG4gKiBmbGFncyB3aGljaCBjb250cm9sIHRoZSBtYXRlcmlhbCBcImJhY2sgZW5kXCIgKHRoZSBzaGFkZXIgcHJvZ3JhbSBjYWxjdWxhdGluZyB0aGUgbGlnaHRpbmcsXG4gKiBzaGFkb3dzLCByZWZsZWN0aW9ucywgZm9nZ2luZyBldGMpLlxuICpcbiAqIFRoZSBmcm9udCBlbmQgYW5kIGJhY2sgZW5kIHRvZ2V0aGVyIGZvcm0gYSBjb21wbGV0ZSBQQlIgc2hhZGVyLlxuICpcbiAqIEBpZ25vcmVcbiAqL1xuY2xhc3MgTGl0TWF0ZXJpYWwgZXh0ZW5kcyBNYXRlcmlhbCB7XG4gICAgdXNlZFV2cyA9IFt0cnVlXTtcblxuICAgIHNoYWRlckNodW5rID0gJ3ZvaWQgZXZhbHVhdGVGcm9udGVuZCgpIHt9XFxuJztcblxuICAgIGNodW5rcyA9IG51bGw7XG5cbiAgICB1c2VMaWdodGluZyA9IHRydWU7XG5cbiAgICB1c2VGb2cgPSB0cnVlO1xuXG4gICAgdXNlR2FtbWFUb25lbWFwID0gdHJ1ZTtcblxuICAgIHVzZVNreWJveCA9IHRydWU7XG5cbiAgICBzaGFkaW5nTW9kZWwgPSBTUEVDVUxBUl9CTElOTjtcblxuICAgIGFtYmllbnRTSCA9IG51bGw7XG5cbiAgICBwaXhlbFNuYXAgPSBmYWxzZTtcblxuICAgIG5pbmVTbGljZWRNb2RlID0gbnVsbDtcblxuICAgIGZhc3RUYm4gPSBmYWxzZTtcblxuICAgIHR3b1NpZGVkTGlnaHRpbmcgPSBmYWxzZTtcblxuICAgIG9jY2x1ZGVEaXJlY3QgPSBmYWxzZTtcblxuICAgIG9jY2x1ZGVTcGVjdWxhciA9IFNQRUNPQ0NfQU87XG5cbiAgICBvY2NsdWRlU3BlY3VsYXJJbnRlbnNpdHkgPSAxO1xuXG4gICAgb3BhY2l0eUZhZGVzU3BlY3VsYXIgPSB0cnVlO1xuXG4gICAgY29uc2VydmVFbmVyZ3kgPSB0cnVlO1xuXG4gICAgZ2d4U3BlY3VsYXIgPSBmYWxzZTtcblxuICAgIGZyZXNuZWxNb2RlbCA9IEZSRVNORUxfU0NITElDSztcblxuICAgIGR5bmFtaWNSZWZyYWN0aW9uID0gZmFsc2U7XG5cbiAgICAvLyBoYXMgbWVtYmVyc1xuICAgIGhhc0FvID0gZmFsc2U7XG5cbiAgICBoYXNTcGVjdWxhciA9IGZhbHNlO1xuXG4gICAgaGFzU3BlY3VsYXJpdHlGYWN0b3IgPSBmYWxzZTtcblxuICAgIGhhc0xpZ2h0aW5nID0gZmFsc2U7XG5cbiAgICBoYXNIZWlnaHRzID0gZmFsc2U7XG5cbiAgICBoYXNOb3JtYWxzID0gZmFsc2U7XG5cbiAgICBoYXNTaGVlbiA9IGZhbHNlO1xuXG4gICAgaGFzUmVmcmFjdGlvbiA9IGZhbHNlO1xuXG4gICAgaGFzSXJyaWRlc2NlbmNlID0gZmFsc2U7XG5cbiAgICBoYXNNZXRhbG5lc3MgPSBmYWxzZTtcblxuICAgIGhhc0NsZWFyQ29hdCA9IGZhbHNlO1xuXG4gICAgaGFzQ2xlYXJDb2F0Tm9ybWFscyA9IGZhbHNlO1xuXG4gICAgZ2V0U2hhZGVyVmFyaWFudChkZXZpY2UsIHNjZW5lLCBvYmpEZWZzLCB1bnVzZWQsIHBhc3MsIHNvcnRlZExpZ2h0cywgdmlld1VuaWZvcm1Gb3JtYXQsIHZpZXdCaW5kR3JvdXBGb3JtYXQsIHZlcnRleEZvcm1hdCkge1xuICAgICAgICBvcHRpb25zLnVzZWRVdnMgPSB0aGlzLnVzZWRVdnMuc2xpY2UoKTtcbiAgICAgICAgb3B0aW9ucy5zaGFkZXJDaHVuayA9IHRoaXMuc2hhZGVyQ2h1bms7XG5cbiAgICAgICAgTGl0TWF0ZXJpYWxPcHRpb25zQnVpbGRlci51cGRhdGUob3B0aW9ucy5saXRPcHRpb25zLCB0aGlzLCBzY2VuZSwgb2JqRGVmcywgcGFzcywgc29ydGVkTGlnaHRzKTtcbiAgICAgICAgY29uc3QgcHJvY2Vzc2luZ09wdGlvbnMgPSBuZXcgU2hhZGVyUHJvY2Vzc29yT3B0aW9ucyh2aWV3VW5pZm9ybUZvcm1hdCwgdmlld0JpbmRHcm91cEZvcm1hdCwgdmVydGV4Rm9ybWF0KTtcbiAgICAgICAgY29uc3QgbGlicmFyeSA9IGdldFByb2dyYW1MaWJyYXJ5KGRldmljZSk7XG4gICAgICAgIGxpYnJhcnkucmVnaXN0ZXIoJ2xpdCcsIGxpdCk7XG4gICAgICAgIGNvbnN0IHNoYWRlciA9IGxpYnJhcnkuZ2V0UHJvZ3JhbSgnbGl0Jywgb3B0aW9ucywgcHJvY2Vzc2luZ09wdGlvbnMsIHRoaXMudXNlcklkKTtcbiAgICAgICAgcmV0dXJuIHNoYWRlcjtcbiAgICB9XG59XG5cbmV4cG9ydCB7IExpdE1hdGVyaWFsIH07XG4iXSwibmFtZXMiOlsib3B0aW9ucyIsIkxpdE1hdGVyaWFsT3B0aW9ucyIsIkxpdE1hdGVyaWFsIiwiTWF0ZXJpYWwiLCJjb25zdHJ1Y3RvciIsImFyZ3MiLCJ1c2VkVXZzIiwic2hhZGVyQ2h1bmsiLCJjaHVua3MiLCJ1c2VMaWdodGluZyIsInVzZUZvZyIsInVzZUdhbW1hVG9uZW1hcCIsInVzZVNreWJveCIsInNoYWRpbmdNb2RlbCIsIlNQRUNVTEFSX0JMSU5OIiwiYW1iaWVudFNIIiwicGl4ZWxTbmFwIiwibmluZVNsaWNlZE1vZGUiLCJmYXN0VGJuIiwidHdvU2lkZWRMaWdodGluZyIsIm9jY2x1ZGVEaXJlY3QiLCJvY2NsdWRlU3BlY3VsYXIiLCJTUEVDT0NDX0FPIiwib2NjbHVkZVNwZWN1bGFySW50ZW5zaXR5Iiwib3BhY2l0eUZhZGVzU3BlY3VsYXIiLCJjb25zZXJ2ZUVuZXJneSIsImdneFNwZWN1bGFyIiwiZnJlc25lbE1vZGVsIiwiRlJFU05FTF9TQ0hMSUNLIiwiZHluYW1pY1JlZnJhY3Rpb24iLCJoYXNBbyIsImhhc1NwZWN1bGFyIiwiaGFzU3BlY3VsYXJpdHlGYWN0b3IiLCJoYXNMaWdodGluZyIsImhhc0hlaWdodHMiLCJoYXNOb3JtYWxzIiwiaGFzU2hlZW4iLCJoYXNSZWZyYWN0aW9uIiwiaGFzSXJyaWRlc2NlbmNlIiwiaGFzTWV0YWxuZXNzIiwiaGFzQ2xlYXJDb2F0IiwiaGFzQ2xlYXJDb2F0Tm9ybWFscyIsImdldFNoYWRlclZhcmlhbnQiLCJkZXZpY2UiLCJzY2VuZSIsIm9iakRlZnMiLCJ1bnVzZWQiLCJwYXNzIiwic29ydGVkTGlnaHRzIiwidmlld1VuaWZvcm1Gb3JtYXQiLCJ2aWV3QmluZEdyb3VwRm9ybWF0IiwidmVydGV4Rm9ybWF0Iiwic2xpY2UiLCJMaXRNYXRlcmlhbE9wdGlvbnNCdWlsZGVyIiwidXBkYXRlIiwibGl0T3B0aW9ucyIsInByb2Nlc3NpbmdPcHRpb25zIiwiU2hhZGVyUHJvY2Vzc29yT3B0aW9ucyIsImxpYnJhcnkiLCJnZXRQcm9ncmFtTGlicmFyeSIsInJlZ2lzdGVyIiwibGl0Iiwic2hhZGVyIiwiZ2V0UHJvZ3JhbSIsInVzZXJJZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFRQSxNQUFNQSxPQUFPLEdBQUcsSUFBSUMsa0JBQWtCLEVBQUUsQ0FBQTs7QUFFeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNQyxXQUFXLFNBQVNDLFFBQVEsQ0FBQztBQUFBQyxFQUFBQSxXQUFBQSxDQUFBLEdBQUFDLElBQUEsRUFBQTtBQUFBLElBQUEsS0FBQSxDQUFBLEdBQUFBLElBQUEsQ0FBQSxDQUFBO0FBQUEsSUFBQSxJQUFBLENBQy9CQyxPQUFPLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUFBLElBRWhCQyxDQUFBQSxXQUFXLEdBQUcsOEJBQThCLENBQUE7SUFBQSxJQUU1Q0MsQ0FBQUEsTUFBTSxHQUFHLElBQUksQ0FBQTtJQUFBLElBRWJDLENBQUFBLFdBQVcsR0FBRyxJQUFJLENBQUE7SUFBQSxJQUVsQkMsQ0FBQUEsTUFBTSxHQUFHLElBQUksQ0FBQTtJQUFBLElBRWJDLENBQUFBLGVBQWUsR0FBRyxJQUFJLENBQUE7SUFBQSxJQUV0QkMsQ0FBQUEsU0FBUyxHQUFHLElBQUksQ0FBQTtJQUFBLElBRWhCQyxDQUFBQSxZQUFZLEdBQUdDLGNBQWMsQ0FBQTtJQUFBLElBRTdCQyxDQUFBQSxTQUFTLEdBQUcsSUFBSSxDQUFBO0lBQUEsSUFFaEJDLENBQUFBLFNBQVMsR0FBRyxLQUFLLENBQUE7SUFBQSxJQUVqQkMsQ0FBQUEsY0FBYyxHQUFHLElBQUksQ0FBQTtJQUFBLElBRXJCQyxDQUFBQSxPQUFPLEdBQUcsS0FBSyxD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
