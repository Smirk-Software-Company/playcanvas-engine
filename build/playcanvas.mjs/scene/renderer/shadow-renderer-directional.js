import { DebugHelper, Debug } from '../../core/debug.js';
import { math } from '../../core/math/math.js';
import { Vec3 } from '../../core/math/vec3.js';
import { Mat4 } from '../../core/math/mat4.js';
import { BoundingBox } from '../../core/shape/bounding-box.js';
import { SHADOWUPDATE_NONE, SHADOWUPDATE_THISFRAME, LIGHTTYPE_DIRECTIONAL } from '../constants.js';
import { RenderPass } from '../../platform/graphics/render-pass.js';
import { ShadowMap } from './shadow-map.js';
import { Quat } from '../../core/math/quat.js';

const visibleSceneAabb = new BoundingBox();
const center = new Vec3();
const shadowCamView = new Mat4();
const aabbPoints = [new Vec3(), new Vec3(), new Vec3(), new Vec3(), new Vec3(), new Vec3(), new Vec3(), new Vec3()];

// evaluate depth range the aabb takes in the space of the camera
const _depthRange = {
  min: 0,
  max: 0
};
function getDepthRange(cameraViewMatrix, aabbMin, aabbMax) {
  aabbPoints[0].x = aabbPoints[1].x = aabbPoints[2].x = aabbPoints[3].x = aabbMin.x;
  aabbPoints[1].y = aabbPoints[3].y = aabbPoints[7].y = aabbPoints[5].y = aabbMin.y;
  aabbPoints[2].z = aabbPoints[3].z = aabbPoints[6].z = aabbPoints[7].z = aabbMin.z;
  aabbPoints[4].x = aabbPoints[5].x = aabbPoints[6].x = aabbPoints[7].x = aabbMax.x;
  aabbPoints[0].y = aabbPoints[2].y = aabbPoints[4].y = aabbPoints[6].y = aabbMax.y;
  aabbPoints[0].z = aabbPoints[1].z = aabbPoints[4].z = aabbPoints[5].z = aabbMax.z;
  let minz = 9999999999;
  let maxz = -9999999999;
  for (let i = 0; i < 8; ++i) {
    cameraViewMatrix.transformPoint(aabbPoints[i], aabbPoints[i]);
    const z = aabbPoints[i].z;
    if (z < minz) minz = z;
    if (z > maxz) maxz = z;
  }
  _depthRange.min = minz;
  _depthRange.max = maxz;
  return _depthRange;
}

/**
 * @ignore
 */
class ShadowRendererDirectional {
  constructor(renderer, shadowRenderer) {
    /** @type {import('./renderer.js').Renderer} */
    this.renderer = void 0;
    /** @type {import('./shadow-renderer.js').ShadowRenderer} */
    this.shadowRenderer = void 0;
    /** @type {import('../../platform/graphics/graphics-device.js').GraphicsDevice} */
    this.device = void 0;
    this.renderer = renderer;
    this.shadowRenderer = shadowRenderer;
    this.device = renderer.device;
  }

  // cull directional shadow map
  cull(light, comp, camera, casters = null) {
    // force light visibility if function was manually called
    light.visibleThisFrame = true;
    if (!light._shadowMap) {
      light._shadowMap = ShadowMap.create(this.device, light);
    }

    // generate splits for the cascades
    const nearDist = camera._nearClip;
    this.generateSplitDistances(light, nearDist, Math.min(camera._farClip, light.shadowDistance));
    const shadowUpdateOverrides = light.shadowUpdateOverrides;
    for (let cascade = 0; cascade < light.numCascades; cascade++) {
      // if manually controlling cascade rendering and the cascade does not render this frame
      if ((shadowUpdateOverrides == null ? void 0 : shadowUpdateOverrides[cascade]) === SHADOWUPDATE_NONE) {
        break;
      }
      const lightRenderData = light.getRenderData(camera, cascade);
      const shadowCam = lightRenderData.shadowCamera;

      // assign render target
      // Note: this is done during rendering for all shadow maps, but do it here for the case shadow rendering for the directional light
      // is disabled - we need shadow map to be assigned for rendering to work even in this case. This needs further refactoring - as when
      // shadow rendering is set to SHADOWUPDATE_NONE, we should not even execute shadow map culling
      shadowCam.renderTarget = light._shadowMap.renderTargets[0];

      // viewport
      lightRenderData.shadowViewport.copy(light.cascades[cascade]);
      lightRenderData.shadowScissor.copy(light.cascades[cascade]);
      const shadowCamNode = shadowCam._node;
      const lightNode = light._node;
      shadowCamNode.setPosition(lightNode.getPosition());

      // Camera looks down the negative Z, and directional light points down the negative Y
      // shadowCamNode.setRotation(lightNode.getRotation());
      // shadowCamNode.setRotation(Quat.IDENTITY);
      shadowCamNode.setRotation(new Quat().setFromEulerAngles(-2, 0, 0));
      shadowCamNode.rotateLocal(-90, 0, 0);

      // get camera's frustum corners for the cascade, convert them to world space and find their center
      const frustumNearDist = cascade === 0 ? nearDist : light._shadowCascadeDistances[cascade - 1];
      const frustumFarDist = light._shadowCascadeDistances[cascade];
      const frustumPoints = camera.getFrustumCorners(frustumNearDist, frustumFarDist);
      center.set(0, 0, 0);
      const cameraWorldMat = camera.node.getWorldTransform();
      for (let i = 0; i < 8; i++) {
        cameraWorldMat.transformPoint(frustumPoints[i], frustumPoints[i]);
        center.add(frustumPoints[i]);
      }
      center.mulScalar(1 / 8);

      // radius of the world space bounding sphere for the frustum slice
      let radius = 0;
      for (let i = 0; i < 8; i++) {
        const dist = frustumPoints[i].sub(center).length();
        if (dist > radius) radius = dist;
      }

      // axis of light coordinate system
      const right = shadowCamNode.right;
      const up = shadowCamNode.up;
      const lightDir = shadowCamNode.forward;

      // transform the sphere's center into the center of the shadow map, pixel aligned.
      // this makes the shadow map stable and avoids shimmering on the edges when the camera moves
      const sizeRatio = 0.25 * light._shadowResolution / radius;
      const x = Math.ceil(center.dot(up) * sizeRatio) / sizeRatio;
      const y = Math.ceil(center.dot(right) * sizeRatio) / sizeRatio;
      const scaledUp = up.mulScalar(x);
      const scaledRight = right.mulScalar(y);
      const dot = center.dot(lightDir);
      const scaledDir = lightDir.mulScalar(dot);
      center.add2(scaledUp, scaledRight).add(scaledDir);

      // look at the center from far away to include all casters during culling
      shadowCamNode.setPosition(center);
      shadowCamNode.translateLocal(0, 0, 1000000);
      shadowCam.nearClip = 0.01;
      shadowCam.farClip = 2000000;
      shadowCam.orthoHeight = radius;

      // cull shadow casters
      this.renderer.updateCameraFrustum(shadowCam);
      this.shadowRenderer.cullShadowCasters(comp, light, lightRenderData.visibleCasters, shadowCam, casters);

      // find out AABB of visible shadow casters
      let emptyAabb = true;
      const visibleCasters = lightRenderData.visibleCasters;
      for (let i = 0; i < visibleCasters.length; i++) {
        const meshInstance = visibleCasters[i];
        if (emptyAabb) {
          emptyAabb = false;
          visibleSceneAabb.copy(meshInstance.aabb);
        } else {
          visibleSceneAabb.add(meshInstance.aabb);
        }
      }

      // calculate depth range of the caster's AABB from the point of view of the shadow camera
      shadowCamView.copy(shadowCamNode.getWorldTransform()).invert();
      const depthRange = getDepthRange(shadowCamView, visibleSceneAabb.getMin(), visibleSceneAabb.getMax());

      // adjust shadow camera's near and far plane to the depth range of casters to maximize precision
      // of values stored in the shadow map. Make it slightly larger to avoid clipping on near / far plane.
      shadowCamNode.translateLocal(0, 0, depthRange.max + 0.1);
      shadowCam.farClip = depthRange.max - depthRange.min + 0.2;
      lightRenderData.depthRangeCompensation = shadowCam.farClip;
      lightRenderData.projectionCompensation = radius;
    }
  }

  // function to generate frustum split distances
  generateSplitDistances(light, nearDist, farDist) {
    light._shadowCascadeDistances.fill(farDist);
    for (let i = 1; i < light.numCascades; i++) {
      //  lerp between linear and logarithmic distance, called practical split distance
      const fraction = i / light.numCascades;
      const linearDist = nearDist + (farDist - nearDist) * fraction;
      const logDist = nearDist * (farDist / nearDist) ** fraction;
      const dist = math.lerp(linearDist, logDist, light.cascadeDistribution);
      light._shadowCascadeDistances[i - 1] = dist;
    }
  }
  addLightRenderPasses(frameGraph, light, camera) {
    // shadow cascades have more faces rendered within a singe render pass
    const faceCount = light.numShadowFaces;
    const shadowUpdateOverrides = light.shadowUpdateOverrides;

    // prepare render targets / cameras for rendering
    let allCascadesRendering = true;
    let shadowCamera;
    for (let face = 0; face < faceCount; face++) {
      if ((shadowUpdateOverrides == null ? void 0 : shadowUpdateOverrides[face]) === SHADOWUPDATE_NONE) allCascadesRendering = false;
      shadowCamera = this.shadowRenderer.prepareFace(light, camera, face);
    }
    const renderPass = new RenderPass(this.device, () => {
      // inside the render pass, render all faces
      for (let face = 0; face < faceCount; face++) {
        if ((shadowUpdateOverrides == null ? void 0 : shadowUpdateOverrides[face]) !== SHADOWUPDATE_NONE) {
          this.shadowRenderer.renderFace(light, camera, face, !allCascadesRendering);
        }
        if ((shadowUpdateOverrides == null ? void 0 : shadowUpdateOverrides[face]) === SHADOWUPDATE_THISFRAME) {
          shadowUpdateOverrides[face] = SHADOWUPDATE_NONE;
        }
      }
    });
    renderPass._after = () => {
      // after the pass is done, apply VSM blur if needed
      this.shadowRenderer.renderVsm(light, camera);
    };

    // setup render pass using any of the cameras, they all have the same pass related properties
    this.shadowRenderer.setupRenderPass(renderPass, shadowCamera, allCascadesRendering);
    DebugHelper.setName(renderPass, `DirShadow-${light._node.name}`);
    frameGraph.addRenderPass(renderPass);
  }

  /**
   * Builds a frame graph for rendering of directional shadows for the render action.
   *
   * @param {import('../frame-graph.js').FrameGraph} frameGraph - The frame-graph that is built.
   * @param {import('../light.js').Light[]} directionalLights - The
   * directional lights.
   * @param {import('../../framework/components/camera/component.js').CameraComponent} camera - The camera.
   */
  buildFrameGraph(frameGraph, directionalLights, camera) {
    // create required render passes per light
    for (let i = 0; i < directionalLights.length; i++) {
      const light = directionalLights[i];
      Debug.assert(light && light._type === LIGHTTYPE_DIRECTIONAL);
      if (this.shadowRenderer.needsShadowRendering(light)) {
        this.addLightRenderPasses(frameGraph, light, camera.camera);
      }
    }
  }
}

export { ShadowRendererDirectional };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhZG93LXJlbmRlcmVyLWRpcmVjdGlvbmFsLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvc2NlbmUvcmVuZGVyZXIvc2hhZG93LXJlbmRlcmVyLWRpcmVjdGlvbmFsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnLCBEZWJ1Z0hlbHBlciB9IGZyb20gJy4uLy4uL2NvcmUvZGVidWcuanMnO1xuaW1wb3J0IHsgbWF0aCB9IGZyb20gJy4uLy4uL2NvcmUvbWF0aC9tYXRoLmpzJztcbmltcG9ydCB7IFZlYzMgfSBmcm9tICcuLi8uLi9jb3JlL21hdGgvdmVjMy5qcyc7XG5pbXBvcnQgeyBNYXQ0IH0gZnJvbSAnLi4vLi4vY29yZS9tYXRoL21hdDQuanMnO1xuaW1wb3J0IHsgQm91bmRpbmdCb3ggfSBmcm9tICcuLi8uLi9jb3JlL3NoYXBlL2JvdW5kaW5nLWJveC5qcyc7XG5cbmltcG9ydCB7XG4gICAgTElHSFRUWVBFX0RJUkVDVElPTkFMLCBTSEFET1dVUERBVEVfTk9ORSwgU0hBRE9XVVBEQVRFX1RISVNGUkFNRVxufSBmcm9tICcuLi9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgUmVuZGVyUGFzcyB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL3JlbmRlci1wYXNzLmpzJztcblxuaW1wb3J0IHsgU2hhZG93TWFwIH0gZnJvbSAnLi9zaGFkb3ctbWFwLmpzJztcbmltcG9ydCB7IFF1YXQgfSBmcm9tICcuLi8uLi9jb3JlL21hdGgvcXVhdC5qcyc7XG5cbmNvbnN0IHZpc2libGVTY2VuZUFhYmIgPSBuZXcgQm91bmRpbmdCb3goKTtcbmNvbnN0IGNlbnRlciA9IG5ldyBWZWMzKCk7XG5jb25zdCBzaGFkb3dDYW1WaWV3ID0gbmV3IE1hdDQoKTtcblxuY29uc3QgYWFiYlBvaW50cyA9IFtcbiAgICBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLFxuICAgIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKClcbl07XG5cbi8vIGV2YWx1YXRlIGRlcHRoIHJhbmdlIHRoZSBhYWJiIHRha2VzIGluIHRoZSBzcGFjZSBvZiB0aGUgY2FtZXJhXG5jb25zdCBfZGVwdGhSYW5nZSA9IHsgbWluOiAwLCBtYXg6IDAgfTtcbmZ1bmN0aW9uIGdldERlcHRoUmFuZ2UoY2FtZXJhVmlld01hdHJpeCwgYWFiYk1pbiwgYWFiYk1heCkge1xuICAgIGFhYmJQb2ludHNbMF0ueCA9IGFhYmJQb2ludHNbMV0ueCA9IGFhYmJQb2ludHNbMl0ueCA9IGFhYmJQb2ludHNbM10ueCA9IGFhYmJNaW4ueDtcbiAgICBhYWJiUG9pbnRzWzFdLnkgPSBhYWJiUG9pbnRzWzNdLnkgPSBhYWJiUG9pbnRzWzddLnkgPSBhYWJiUG9pbnRzWzVdLnkgPSBhYWJiTWluLnk7XG4gICAgYWFiYlBvaW50c1syXS56ID0gYWFiYlBvaW50c1szXS56ID0gYWFiYlBvaW50c1s2XS56ID0gYWFiYlBvaW50c1s3XS56ID0gYWFiYk1pbi56O1xuICAgIGFhYmJQb2ludHNbNF0ueCA9IGFhYmJQb2ludHNbNV0ueCA9IGFhYmJQb2ludHNbNl0ueCA9IGFhYmJQb2ludHNbN10ueCA9IGFhYmJNYXgueDtcbiAgICBhYWJiUG9pbnRzWzBdLnkgPSBhYWJiUG9pbnRzWzJdLnkgPSBhYWJiUG9pbnRzWzRdLnkgPSBhYWJiUG9pbnRzWzZdLnkgPSBhYWJiTWF4Lnk7XG4gICAgYWFiYlBvaW50c1swXS56ID0gYWFiYlBvaW50c1sxXS56ID0gYWFiYlBvaW50c1s0XS56ID0gYWFiYlBvaW50c1s1XS56ID0gYWFiYk1heC56O1xuXG4gICAgbGV0IG1pbnogPSA5OTk5OTk5OTk5O1xuICAgIGxldCBtYXh6ID0gLTk5OTk5OTk5OTk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDg7ICsraSkge1xuICAgICAgICBjYW1lcmFWaWV3TWF0cml4LnRyYW5zZm9ybVBvaW50KGFhYmJQb2ludHNbaV0sIGFhYmJQb2ludHNbaV0pO1xuICAgICAgICBjb25zdCB6ID0gYWFiYlBvaW50c1tpXS56O1xuICAgICAgICBpZiAoeiA8IG1pbnopIG1pbnogPSB6O1xuICAgICAgICBpZiAoeiA+IG1heHopIG1heHogPSB6O1xuICAgIH1cblxuICAgIF9kZXB0aFJhbmdlLm1pbiA9IG1pbno7XG4gICAgX2RlcHRoUmFuZ2UubWF4ID0gbWF4ejtcbiAgICByZXR1cm4gX2RlcHRoUmFuZ2U7XG59XG5cbi8qKlxuICogQGlnbm9yZVxuICovXG5jbGFzcyBTaGFkb3dSZW5kZXJlckRpcmVjdGlvbmFsIHtcbiAgICAvKiogQHR5cGUge2ltcG9ydCgnLi9yZW5kZXJlci5qcycpLlJlbmRlcmVyfSAqL1xuICAgIHJlbmRlcmVyO1xuXG4gICAgLyoqIEB0eXBlIHtpbXBvcnQoJy4vc2hhZG93LXJlbmRlcmVyLmpzJykuU2hhZG93UmVuZGVyZXJ9ICovXG4gICAgc2hhZG93UmVuZGVyZXI7XG5cbiAgICAvKiogQHR5cGUge2ltcG9ydCgnLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3MvZ3JhcGhpY3MtZGV2aWNlLmpzJykuR3JhcGhpY3NEZXZpY2V9ICovXG4gICAgZGV2aWNlO1xuXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIHNoYWRvd1JlbmRlcmVyKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgdGhpcy5zaGFkb3dSZW5kZXJlciA9IHNoYWRvd1JlbmRlcmVyO1xuICAgICAgICB0aGlzLmRldmljZSA9IHJlbmRlcmVyLmRldmljZTtcbiAgICB9XG5cbiAgICAvLyBjdWxsIGRpcmVjdGlvbmFsIHNoYWRvdyBtYXBcbiAgICBjdWxsKGxpZ2h0LCBjb21wLCBjYW1lcmEsIGNhc3RlcnMgPSBudWxsKSB7XG5cbiAgICAgICAgLy8gZm9yY2UgbGlnaHQgdmlzaWJpbGl0eSBpZiBmdW5jdGlvbiB3YXMgbWFudWFsbHkgY2FsbGVkXG4gICAgICAgIGxpZ2h0LnZpc2libGVUaGlzRnJhbWUgPSB0cnVlO1xuXG4gICAgICAgIGlmICghbGlnaHQuX3NoYWRvd01hcCkge1xuICAgICAgICAgICAgbGlnaHQuX3NoYWRvd01hcCA9IFNoYWRvd01hcC5jcmVhdGUodGhpcy5kZXZpY2UsIGxpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGdlbmVyYXRlIHNwbGl0cyBmb3IgdGhlIGNhc2NhZGVzXG4gICAgICAgIGNvbnN0IG5lYXJEaXN0ID0gY2FtZXJhLl9uZWFyQ2xpcDtcbiAgICAgICAgdGhpcy5nZW5lcmF0ZVNwbGl0RGlzdGFuY2VzKGxpZ2h0LCBuZWFyRGlzdCwgTWF0aC5taW4oY2FtZXJhLl9mYXJDbGlwLCBsaWdodC5zaGFkb3dEaXN0YW5jZSkpO1xuXG4gICAgICAgIGNvbnN0IHNoYWRvd1VwZGF0ZU92ZXJyaWRlcyA9IGxpZ2h0LnNoYWRvd1VwZGF0ZU92ZXJyaWRlcztcbiAgICAgICAgZm9yIChsZXQgY2FzY2FkZSA9IDA7IGNhc2NhZGUgPCBsaWdodC5udW1DYXNjYWRlczsgY2FzY2FkZSsrKSB7XG5cbiAgICAgICAgICAgIC8vIGlmIG1hbnVhbGx5IGNvbnRyb2xsaW5nIGNhc2NhZGUgcmVuZGVyaW5nIGFuZCB0aGUgY2FzY2FkZSBkb2VzIG5vdCByZW5kZXIgdGhpcyBmcmFtZVxuICAgICAgICAgICAgaWYgKHNoYWRvd1VwZGF0ZU92ZXJyaWRlcz8uW2Nhc2NhZGVdID09PSBTSEFET1dVUERBVEVfTk9ORSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBsaWdodFJlbmRlckRhdGEgPSBsaWdodC5nZXRSZW5kZXJEYXRhKGNhbWVyYSwgY2FzY2FkZSk7XG4gICAgICAgICAgICBjb25zdCBzaGFkb3dDYW0gPSBsaWdodFJlbmRlckRhdGEuc2hhZG93Q2FtZXJhO1xuXG4gICAgICAgICAgICAvLyBhc3NpZ24gcmVuZGVyIHRhcmdldFxuICAgICAgICAgICAgLy8gTm90ZTogdGhpcyBpcyBkb25lIGR1cmluZyByZW5kZXJpbmcgZm9yIGFsbCBzaGFkb3cgbWFwcywgYnV0IGRvIGl0IGhlcmUgZm9yIHRoZSBjYXNlIHNoYWRvdyByZW5kZXJpbmcgZm9yIHRoZSBkaXJlY3Rpb25hbCBsaWdodFxuICAgICAgICAgICAgLy8gaXMgZGlzYWJsZWQgLSB3ZSBuZWVkIHNoYWRvdyBtYXAgdG8gYmUgYXNzaWduZWQgZm9yIHJlbmRlcmluZyB0byB3b3JrIGV2ZW4gaW4gdGhpcyBjYXNlLiBUaGlzIG5lZWRzIGZ1cnRoZXIgcmVmYWN0b3JpbmcgLSBhcyB3aGVuXG4gICAgICAgICAgICAvLyBzaGFkb3cgcmVuZGVyaW5nIGlzIHNldCB0byBTSEFET1dVUERBVEVfTk9ORSwgd2Ugc2hvdWxkIG5vdCBldmVuIGV4ZWN1dGUgc2hhZG93IG1hcCBjdWxsaW5nXG4gICAgICAgICAgICBzaGFkb3dDYW0ucmVuZGVyVGFyZ2V0ID0gbGlnaHQuX3NoYWRvd01hcC5yZW5kZXJUYXJnZXRzWzBdO1xuXG4gICAgICAgICAgICAvLyB2aWV3cG9ydFxuICAgICAgICAgICAgbGlnaHRSZW5kZXJEYXRhLnNoYWRvd1ZpZXdwb3J0LmNvcHkobGlnaHQuY2FzY2FkZXNbY2FzY2FkZV0pO1xuICAgICAgICAgICAgbGlnaHRSZW5kZXJEYXRhLnNoYWRvd1NjaXNzb3IuY29weShsaWdodC5jYXNjYWRlc1tjYXNjYWRlXSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHNoYWRvd0NhbU5vZGUgPSBzaGFkb3dDYW0uX25vZGU7XG4gICAgICAgICAgICBjb25zdCBsaWdodE5vZGUgPSBsaWdodC5fbm9kZTtcblxuICAgICAgICAgICAgc2hhZG93Q2FtTm9kZS5zZXRQb3NpdGlvbihsaWdodE5vZGUuZ2V0UG9zaXRpb24oKSk7XG5cbiAgICAgICAgICAgIC8vIENhbWVyYSBsb29rcyBkb3duIHRoZSBuZWdhdGl2ZSBaLCBhbmQgZGlyZWN0aW9uYWwgbGlnaHQgcG9pbnRzIGRvd24gdGhlIG5lZ2F0aXZlIFlcbiAgICAgICAgICAgIC8vIHNoYWRvd0NhbU5vZGUuc2V0Um90YXRpb24obGlnaHROb2RlLmdldFJvdGF0aW9uKCkpO1xuICAgICAgICAgICAgLy8gc2hhZG93Q2FtTm9kZS5zZXRSb3RhdGlvbihRdWF0LklERU5USVRZKTtcbiAgICAgICAgICAgIHNoYWRvd0NhbU5vZGUuc2V0Um90YXRpb24obmV3IFF1YXQoKS5zZXRGcm9tRXVsZXJBbmdsZXMoLTIsIDAsIDApKTtcbiAgICAgICAgICAgIHNoYWRvd0NhbU5vZGUucm90YXRlTG9jYWwoLTkwLCAwLCAwKTtcblxuICAgICAgICAgICAgLy8gZ2V0IGNhbWVyYSdzIGZydXN0dW0gY29ybmVycyBmb3IgdGhlIGNhc2NhZGUsIGNvbnZlcnQgdGhlbSB0byB3b3JsZCBzcGFjZSBhbmQgZmluZCB0aGVpciBjZW50ZXJcbiAgICAgICAgICAgIGNvbnN0IGZydXN0dW1OZWFyRGlzdCA9IGNhc2NhZGUgPT09IDAgPyBuZWFyRGlzdCA6IGxpZ2h0Ll9zaGFkb3dDYXNjYWRlRGlzdGFuY2VzW2Nhc2NhZGUgLSAxXTtcbiAgICAgICAgICAgIGNvbnN0IGZydXN0dW1GYXJEaXN0ID0gbGlnaHQuX3NoYWRvd0Nhc2NhZGVEaXN0YW5jZXNbY2FzY2FkZV07XG4gICAgICAgICAgICBjb25zdCBmcnVzdHVtUG9pbnRzID0gY2FtZXJhLmdldEZydXN0dW1Db3JuZXJzKGZydXN0dW1OZWFyRGlzdCwgZnJ1c3R1bUZhckRpc3QpO1xuICAgICAgICAgICAgY2VudGVyLnNldCgwLCAwLCAwKTtcbiAgICAgICAgICAgIGNvbnN0IGNhbWVyYVdvcmxkTWF0ID0gY2FtZXJhLm5vZGUuZ2V0V29ybGRUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY2FtZXJhV29ybGRNYXQudHJhbnNmb3JtUG9pbnQoZnJ1c3R1bVBvaW50c1tpXSwgZnJ1c3R1bVBvaW50c1tpXSk7XG4gICAgICAgICAgICAgICAgY2VudGVyLmFkZChmcnVzdHVtUG9pbnRzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNlbnRlci5tdWxTY2FsYXIoMSAvIDgpO1xuXG4gICAgICAgICAgICAvLyByYWRpdXMgb2YgdGhlIHdvcmxkIHNwYWNlIGJvdW5kaW5nIHNwaGVyZSBmb3IgdGhlIGZydXN0dW0gc2xpY2VcbiAgICAgICAgICAgIGxldCByYWRpdXMgPSAwO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXN0ID0gZnJ1c3R1bVBvaW50c1tpXS5zdWIoY2VudGVyKS5sZW5ndGgoKTtcbiAgICAgICAgICAgICAgICBpZiAoZGlzdCA+IHJhZGl1cylcbiAgICAgICAgICAgICAgICAgICAgcmFkaXVzID0gZGlzdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYXhpcyBvZiBsaWdodCBjb29yZGluYXRlIHN5c3RlbVxuICAgICAgICAgICAgY29uc3QgcmlnaHQgPSBzaGFkb3dDYW1Ob2RlLnJpZ2h0O1xuICAgICAgICAgICAgY29uc3QgdXAgPSBzaGFkb3dDYW1Ob2RlLnVwO1xuICAgICAgICAgICAgY29uc3QgbGlnaHREaXIgPSBzaGFkb3dDYW1Ob2RlLmZvcndhcmQ7XG5cbiAgICAgICAgICAgIC8vIHRyYW5zZm9ybSB0aGUgc3BoZXJlJ3MgY2VudGVyIGludG8gdGhlIGNlbnRlciBvZiB0aGUgc2hhZG93IG1hcCwgcGl4ZWwgYWxpZ25lZC5cbiAgICAgICAgICAgIC8vIHRoaXMgbWFrZXMgdGhlIHNoYWRvdyBtYXAgc3RhYmxlIGFuZCBhdm9pZHMgc2hpbW1lcmluZyBvbiB0aGUgZWRnZXMgd2hlbiB0aGUgY2FtZXJhIG1vdmVzXG4gICAgICAgICAgICBjb25zdCBzaXplUmF0aW8gPSAwLjI1ICogbGlnaHQuX3NoYWRvd1Jlc29sdXRpb24gLyByYWRpdXM7XG4gICAgICAgICAgICBjb25zdCB4ID0gTWF0aC5jZWlsKGNlbnRlci5kb3QodXApICogc2l6ZVJhdGlvKSAvIHNpemVSYXRpbztcbiAgICAgICAgICAgIGNvbnN0IHkgPSBNYXRoLmNlaWwoY2VudGVyLmRvdChyaWdodCkgKiBzaXplUmF0aW8pIC8gc2l6ZVJhdGlvO1xuXG4gICAgICAgICAgICBjb25zdCBzY2FsZWRVcCA9IHVwLm11bFNjYWxhcih4KTtcbiAgICAgICAgICAgIGNvbnN0IHNjYWxlZFJpZ2h0ID0gcmlnaHQubXVsU2NhbGFyKHkpO1xuICAgICAgICAgICAgY29uc3QgZG90ID0gY2VudGVyLmRvdChsaWdodERpcik7XG4gICAgICAgICAgICBjb25zdCBzY2FsZWREaXIgPSBsaWdodERpci5tdWxTY2FsYXIoZG90KTtcbiAgICAgICAgICAgIGNlbnRlci5hZGQyKHNjYWxlZFVwLCBzY2FsZWRSaWdodCkuYWRkKHNjYWxlZERpcik7XG5cbiAgICAgICAgICAgIC8vIGxvb2sgYXQgdGhlIGNlbnRlciBmcm9tIGZhciBhd2F5IHRvIGluY2x1ZGUgYWxsIGNhc3RlcnMgZHVyaW5nIGN1bGxpbmdcbiAgICAgICAgICAgIHNoYWRvd0NhbU5vZGUuc2V0UG9zaXRpb24oY2VudGVyKTtcbiAgICAgICAgICAgIHNoYWRvd0NhbU5vZGUudHJhbnNsYXRlTG9jYWwoMCwgMCwgMTAwMDAwMCk7XG4gICAgICAgICAgICBzaGFkb3dDYW0ubmVhckNsaXAgPSAwLjAxO1xuICAgICAgICAgICAgc2hhZG93Q2FtLmZhckNsaXAgPSAyMDAwMDAwO1xuICAgICAgICAgICAgc2hhZG93Q2FtLm9ydGhvSGVpZ2h0ID0gcmFkaXVzO1xuXG4gICAgICAgICAgICAvLyBjdWxsIHNoYWRvdyBjYXN0ZXJzXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnVwZGF0ZUNhbWVyYUZydXN0dW0oc2hhZG93Q2FtKTtcbiAgICAgICAgICAgIHRoaXMuc2hhZG93UmVuZGVyZXIuY3VsbFNoYWRvd0Nhc3RlcnMoY29tcCwgbGlnaHQsIGxpZ2h0UmVuZGVyRGF0YS52aXNpYmxlQ2FzdGVycywgc2hhZG93Q2FtLCBjYXN0ZXJzKTtcblxuICAgICAgICAgICAgLy8gZmluZCBvdXQgQUFCQiBvZiB2aXNpYmxlIHNoYWRvdyBjYXN0ZXJzXG4gICAgICAgICAgICBsZXQgZW1wdHlBYWJiID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHZpc2libGVDYXN0ZXJzID0gbGlnaHRSZW5kZXJEYXRhLnZpc2libGVDYXN0ZXJzO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2aXNpYmxlQ2FzdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc2hJbnN0YW5jZSA9IHZpc2libGVDYXN0ZXJzW2ldO1xuXG4gICAgICAgICAgICAgICAgaWYgKGVtcHR5QWFiYikge1xuICAgICAgICAgICAgICAgICAgICBlbXB0eUFhYmIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZVNjZW5lQWFiYi5jb3B5KG1lc2hJbnN0YW5jZS5hYWJiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlU2NlbmVBYWJiLmFkZChtZXNoSW5zdGFuY2UuYWFiYik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgZGVwdGggcmFuZ2Ugb2YgdGhlIGNhc3RlcidzIEFBQkIgZnJvbSB0aGUgcG9pbnQgb2YgdmlldyBvZiB0aGUgc2hhZG93IGNhbWVyYVxuICAgICAgICAgICAgc2hhZG93Q2FtVmlldy5jb3B5KHNoYWRvd0NhbU5vZGUuZ2V0V29ybGRUcmFuc2Zvcm0oKSkuaW52ZXJ0KCk7XG4gICAgICAgICAgICBjb25zdCBkZXB0aFJhbmdlID0gZ2V0RGVwdGhSYW5nZShzaGFkb3dDYW1WaWV3LCB2aXNpYmxlU2NlbmVBYWJiLmdldE1pbigpLCB2aXNpYmxlU2NlbmVBYWJiLmdldE1heCgpKTtcblxuICAgICAgICAgICAgLy8gYWRqdXN0IHNoYWRvdyBjYW1lcmEncyBuZWFyIGFuZCBmYXIgcGxhbmUgdG8gdGhlIGRlcHRoIHJhbmdlIG9mIGNhc3RlcnMgdG8gbWF4aW1pemUgcHJlY2lzaW9uXG4gICAgICAgICAgICAvLyBvZiB2YWx1ZXMgc3RvcmVkIGluIHRoZSBzaGFkb3cgbWFwLiBNYWtlIGl0IHNsaWdodGx5IGxhcmdlciB0byBhdm9pZCBjbGlwcGluZyBvbiBuZWFyIC8gZmFyIHBsYW5lLlxuICAgICAgICAgICAgc2hhZG93Q2FtTm9kZS50cmFuc2xhdGVMb2NhbCgwLCAwLCBkZXB0aFJhbmdlLm1heCArIDAuMSk7XG4gICAgICAgICAgICBzaGFkb3dDYW0uZmFyQ2xpcCA9IGRlcHRoUmFuZ2UubWF4IC0gZGVwdGhSYW5nZS5taW4gKyAwLjI7XG5cbiAgICAgICAgICAgIGxpZ2h0UmVuZGVyRGF0YS5kZXB0aFJhbmdlQ29tcGVuc2F0aW9uID0gc2hhZG93Q2FtLmZhckNsaXA7XG4gICAgICAgICAgICBsaWdodFJlbmRlckRhdGEucHJvamVjdGlvbkNvbXBlbnNhdGlvbiA9IHJhZGl1cztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIGZydXN0dW0gc3BsaXQgZGlzdGFuY2VzXG4gICAgZ2VuZXJhdGVTcGxpdERpc3RhbmNlcyhsaWdodCwgbmVhckRpc3QsIGZhckRpc3QpIHtcblxuICAgICAgICBsaWdodC5fc2hhZG93Q2FzY2FkZURpc3RhbmNlcy5maWxsKGZhckRpc3QpO1xuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxpZ2h0Lm51bUNhc2NhZGVzOyBpKyspIHtcblxuICAgICAgICAgICAgLy8gIGxlcnAgYmV0d2VlbiBsaW5lYXIgYW5kIGxvZ2FyaXRobWljIGRpc3RhbmNlLCBjYWxsZWQgcHJhY3RpY2FsIHNwbGl0IGRpc3RhbmNlXG4gICAgICAgICAgICBjb25zdCBmcmFjdGlvbiA9IGkgLyBsaWdodC5udW1DYXNjYWRlcztcbiAgICAgICAgICAgIGNvbnN0IGxpbmVhckRpc3QgPSBuZWFyRGlzdCArIChmYXJEaXN0IC0gbmVhckRpc3QpICogZnJhY3Rpb247XG4gICAgICAgICAgICBjb25zdCBsb2dEaXN0ID0gbmVhckRpc3QgKiAoZmFyRGlzdCAvIG5lYXJEaXN0KSAqKiBmcmFjdGlvbjtcbiAgICAgICAgICAgIGNvbnN0IGRpc3QgPSBtYXRoLmxlcnAobGluZWFyRGlzdCwgbG9nRGlzdCwgbGlnaHQuY2FzY2FkZURpc3RyaWJ1dGlvbik7XG4gICAgICAgICAgICBsaWdodC5fc2hhZG93Q2FzY2FkZURpc3RhbmNlc1tpIC0gMV0gPSBkaXN0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWRkTGlnaHRSZW5kZXJQYXNzZXMoZnJhbWVHcmFwaCwgbGlnaHQsIGNhbWVyYSkge1xuXG4gICAgICAgIC8vIHNoYWRvdyBjYXNjYWRlcyBoYXZlIG1vcmUgZmFjZXMgcmVuZGVyZWQgd2l0aGluIGEgc2luZ2UgcmVuZGVyIHBhc3NcbiAgICAgICAgY29uc3QgZmFjZUNvdW50ID0gbGlnaHQubnVtU2hhZG93RmFjZXM7XG4gICAgICAgIGNvbnN0IHNoYWRvd1VwZGF0ZU92ZXJyaWRlcyA9IGxpZ2h0LnNoYWRvd1VwZGF0ZU92ZXJyaWRlcztcblxuICAgICAgICAvLyBwcmVwYXJlIHJlbmRlciB0YXJnZXRzIC8gY2FtZXJhcyBmb3IgcmVuZGVyaW5nXG4gICAgICAgIGxldCBhbGxDYXNjYWRlc1JlbmRlcmluZyA9IHRydWU7XG4gICAgICAgIGxldCBzaGFkb3dDYW1lcmE7XG4gICAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgZmFjZUNvdW50OyBmYWNlKyspIHtcblxuICAgICAgICAgICAgaWYgKHNoYWRvd1VwZGF0ZU92ZXJyaWRlcz8uW2ZhY2VdID09PSBTSEFET1dVUERBVEVfTk9ORSlcbiAgICAgICAgICAgICAgICBhbGxDYXNjYWRlc1JlbmRlcmluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICBzaGFkb3dDYW1lcmEgPSB0aGlzLnNoYWRvd1JlbmRlcmVyLnByZXBhcmVGYWNlKGxpZ2h0LCBjYW1lcmEsIGZhY2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVuZGVyUGFzcyA9IG5ldyBSZW5kZXJQYXNzKHRoaXMuZGV2aWNlLCAoKSA9PiB7XG5cbiAgICAgICAgICAgIC8vIGluc2lkZSB0aGUgcmVuZGVyIHBhc3MsIHJlbmRlciBhbGwgZmFjZXNcbiAgICAgICAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgZmFjZUNvdW50OyBmYWNlKyspIHtcblxuICAgICAgICAgICAgICAgIGlmIChzaGFkb3dVcGRhdGVPdmVycmlkZXM/LltmYWNlXSAhPT0gU0hBRE9XVVBEQVRFX05PTkUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFkb3dSZW5kZXJlci5yZW5kZXJGYWNlKGxpZ2h0LCBjYW1lcmEsIGZhY2UsICFhbGxDYXNjYWRlc1JlbmRlcmluZyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHNoYWRvd1VwZGF0ZU92ZXJyaWRlcz8uW2ZhY2VdID09PSBTSEFET1dVUERBVEVfVEhJU0ZSQU1FKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYWRvd1VwZGF0ZU92ZXJyaWRlc1tmYWNlXSA9IFNIQURPV1VQREFURV9OT05FO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmVuZGVyUGFzcy5fYWZ0ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyBhZnRlciB0aGUgcGFzcyBpcyBkb25lLCBhcHBseSBWU00gYmx1ciBpZiBuZWVkZWRcbiAgICAgICAgICAgIHRoaXMuc2hhZG93UmVuZGVyZXIucmVuZGVyVnNtKGxpZ2h0LCBjYW1lcmEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHNldHVwIHJlbmRlciBwYXNzIHVzaW5nIGFueSBvZiB0aGUgY2FtZXJhcywgdGhleSBhbGwgaGF2ZSB0aGUgc2FtZSBwYXNzIHJlbGF0ZWQgcHJvcGVydGllc1xuICAgICAgICB0aGlzLnNoYWRvd1JlbmRlcmVyLnNldHVwUmVuZGVyUGFzcyhyZW5kZXJQYXNzLCBzaGFkb3dDYW1lcmEsIGFsbENhc2NhZGVzUmVuZGVyaW5nKTtcbiAgICAgICAgRGVidWdIZWxwZXIuc2V0TmFtZShyZW5kZXJQYXNzLCBgRGlyU2hhZG93LSR7bGlnaHQuX25vZGUubmFtZX1gKTtcblxuICAgICAgICBmcmFtZUdyYXBoLmFkZFJlbmRlclBhc3MocmVuZGVyUGFzcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGRzIGEgZnJhbWUgZ3JhcGggZm9yIHJlbmRlcmluZyBvZiBkaXJlY3Rpb25hbCBzaGFkb3dzIGZvciB0aGUgcmVuZGVyIGFjdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9mcmFtZS1ncmFwaC5qcycpLkZyYW1lR3JhcGh9IGZyYW1lR3JhcGggLSBUaGUgZnJhbWUtZ3JhcGggdGhhdCBpcyBidWlsdC5cbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vbGlnaHQuanMnKS5MaWdodFtdfSBkaXJlY3Rpb25hbExpZ2h0cyAtIFRoZVxuICAgICAqIGRpcmVjdGlvbmFsIGxpZ2h0cy5cbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vLi4vZnJhbWV3b3JrL2NvbXBvbmVudHMvY2FtZXJhL2NvbXBvbmVudC5qcycpLkNhbWVyYUNvbXBvbmVudH0gY2FtZXJhIC0gVGhlIGNhbWVyYS5cbiAgICAgKi9cbiAgICBidWlsZEZyYW1lR3JhcGgoZnJhbWVHcmFwaCwgZGlyZWN0aW9uYWxMaWdodHMsIGNhbWVyYSkge1xuXG4gICAgICAgIC8vIGNyZWF0ZSByZXF1aXJlZCByZW5kZXIgcGFzc2VzIHBlciBsaWdodFxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpcmVjdGlvbmFsTGlnaHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsaWdodCA9IGRpcmVjdGlvbmFsTGlnaHRzW2ldO1xuICAgICAgICAgICAgRGVidWcuYXNzZXJ0KGxpZ2h0ICYmIGxpZ2h0Ll90eXBlID09PSBMSUdIVFRZUEVfRElSRUNUSU9OQUwpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zaGFkb3dSZW5kZXJlci5uZWVkc1NoYWRvd1JlbmRlcmluZyhsaWdodCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZExpZ2h0UmVuZGVyUGFzc2VzKGZyYW1lR3JhcGgsIGxpZ2h0LCBjYW1lcmEuY2FtZXJhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgU2hhZG93UmVuZGVyZXJEaXJlY3Rpb25hbCB9O1xuIl0sIm5hbWVzIjpbInZpc2libGVTY2VuZUFhYmIiLCJCb3VuZGluZ0JveCIsImNlbnRlciIsIlZlYzMiLCJzaGFkb3dDYW1WaWV3IiwiTWF0NCIsImFhYmJQb2ludHMiLCJfZGVwdGhSYW5nZSIsIm1pbiIsIm1heCIsImdldERlcHRoUmFuZ2UiLCJjYW1lcmFWaWV3TWF0cml4IiwiYWFiYk1pbiIsImFhYmJNYXgiLCJ4IiwieSIsInoiLCJtaW56IiwibWF4eiIsImkiLCJ0cmFuc2Zvcm1Qb2ludCIsIlNoYWRvd1JlbmRlcmVyRGlyZWN0aW9uYWwiLCJjb25zdHJ1Y3RvciIsInJlbmRlcmVyIiwic2hhZG93UmVuZGVyZXIiLCJkZXZpY2UiLCJjdWxsIiwibGlnaHQiLCJjb21wIiwiY2FtZXJhIiwiY2FzdGVycyIsInZpc2libGVUaGlzRnJhbWUiLCJfc2hhZG93TWFwIiwiU2hhZG93TWFwIiwiY3JlYXRlIiwibmVhckRpc3QiLCJfbmVhckNsaXAiLCJnZW5lcmF0ZVNwbGl0RGlzdGFuY2VzIiwiTWF0aCIsIl9mYXJDbGlwIiwic2hhZG93RGlzdGFuY2UiLCJzaGFkb3dVcGRhdGVPdmVycmlkZXMiLCJjYXNjYWRlIiwibnVtQ2FzY2FkZXMiLCJTSEFET1dVUERBVEVfTk9ORSIsImxpZ2h0UmVuZGVyRGF0YSIsImdldFJlbmRlckRhdGEiLCJzaGFkb3dDYW0iLCJzaGFkb3dDYW1lcmEiLCJyZW5kZXJUYXJnZXQiLCJyZW5kZXJUYXJnZXRzIiwic2hhZG93Vmlld3BvcnQiLCJjb3B5IiwiY2FzY2FkZXMiLCJzaGFkb3dTY2lzc29yIiwic2hhZG93Q2FtTm9kZSIsIl9ub2RlIiwibGlnaHROb2RlIiwic2V0UG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsInNldFJvdGF0aW9uIiwiUXVhdCIsInNldEZyb21FdWxlckFuZ2xlcyIsInJvdGF0ZUxvY2FsIiwiZnJ1c3R1bU5lYXJEaXN0IiwiX3NoYWRvd0Nhc2NhZGVEaXN0YW5jZXMiLCJmcnVzdHVtRmFyRGlzdCIsImZydXN0dW1Qb2ludHMiLCJnZXRGcnVzdHVtQ29ybmVycyIsInNldCIsImNhbWVyYVdvcmxkTWF0Iiwibm9kZSIsImdldFdvcmxkVHJhbnNmb3JtIiwiYWRkIiwibXVsU2NhbGFyIiwicmFkaXVzIiwiZGlzdCIsInN1YiIsImxlbmd0aCIsInJpZ2h0IiwidXAiLCJsaWdodERpciIsImZvcndhcmQiLCJzaXplUmF0aW8iLCJfc2hhZG93UmVzb2x1dGlvbiIsImNlaWwiLCJkb3QiLCJzY2FsZWRVcCIsInNjYWxlZFJpZ2h0Iiwic2NhbGVkRGlyIiwiYWRkMiIsInRyYW5zbGF0ZUxvY2FsIiwibmVhckNsaXAiLCJmYXJDbGlwIiwib3J0aG9IZWlnaHQiLCJ1cGRhdGVDYW1lcmFGcnVzdHVtIiwiY3VsbFNoYWRvd0Nhc3RlcnMiLCJ2aXNpYmxlQ2FzdGVycyIsImVtcHR5QWFiYiIsIm1lc2hJbnN0YW5jZSIsImFhYmIiLCJpbnZlcnQiLCJkZXB0aFJhbmdlIiwiZ2V0TWluIiwiZ2V0TWF4IiwiZGVwdGhSYW5nZUNvbXBlbnNhdGlvbiIsInByb2plY3Rpb25Db21wZW5zYXRpb24iLCJmYXJEaXN0IiwiZmlsbCIsImZyYWN0aW9uIiwibGluZWFyRGlzdCIsImxvZ0Rpc3QiLCJtYXRoIiwibGVycCIsImNhc2NhZGVEaXN0cmlidXRpb24iLCJhZGRMaWdodFJlbmRlclBhc3NlcyIsImZyYW1lR3JhcGgiLCJmYWNlQ291bnQiLCJudW1TaGFkb3dGYWNlcyIsImFsbENhc2NhZGVzUmVuZGVyaW5nIiwiZmFjZSIsInByZXBhcmVGYWNlIiwicmVuZGVyUGFzcyIsIlJlbmRlclBhc3MiLCJyZW5kZXJGYWNlIiwiU0hBRE9XVVBEQVRFX1RISVNGUkFNRSIsIl9hZnRlciIsInJlbmRlclZzbSIsInNldHVwUmVuZGVyUGFzcyIsIkRlYnVnSGVscGVyIiwic2V0TmFtZSIsIm5hbWUiLCJhZGRSZW5kZXJQYXNzIiwiYnVpbGRGcmFtZUdyYXBoIiwiZGlyZWN0aW9uYWxMaWdodHMiLCJEZWJ1ZyIsImFzc2VydCIsIl90eXBlIiwiTElHSFRUWVBFX0RJUkVDVElPTkFMIiwibmVlZHNTaGFkb3dSZW5kZXJpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFjQSxNQUFNQSxnQkFBZ0IsR0FBRyxJQUFJQyxXQUFXLEVBQUUsQ0FBQTtBQUMxQyxNQUFNQyxNQUFNLEdBQUcsSUFBSUMsSUFBSSxFQUFFLENBQUE7QUFDekIsTUFBTUMsYUFBYSxHQUFHLElBQUlDLElBQUksRUFBRSxDQUFBO0FBRWhDLE1BQU1DLFVBQVUsR0FBRyxDQUNmLElBQUlILElBQUksRUFBRSxFQUFFLElBQUlBLElBQUksRUFBRSxFQUFFLElBQUlBLElBQUksRUFBRSxFQUFFLElBQUlBLElBQUksRUFBRSxFQUM5QyxJQUFJQSxJQUFJLEVBQUUsRUFBRSxJQUFJQSxJQUFJLEVBQUUsRUFBRSxJQUFJQSxJQUFJLEVBQUUsRUFBRSxJQUFJQSxJQUFJLEVBQUUsQ0FDakQsQ0FBQTs7QUFFRDtBQUNBLE1BQU1JLFdBQVcsR0FBRztBQUFFQyxFQUFBQSxHQUFHLEVBQUUsQ0FBQztBQUFFQyxFQUFBQSxHQUFHLEVBQUUsQ0FBQTtBQUFFLENBQUMsQ0FBQTtBQUN0QyxTQUFTQyxhQUFhQSxDQUFDQyxnQkFBZ0IsRUFBRUMsT0FBTyxFQUFFQyxPQUFPLEVBQUU7QUFDdkRQLEVBQUFBLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQ1EsQ0FBQyxHQUFHUixVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUNRLENBQUMsR0FBR1IsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDUSxDQUFDLEdBQUdSLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQ1EsQ0FBQyxH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
