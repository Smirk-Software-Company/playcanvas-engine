import { path } from '../../core/path.js';
import { Debug } from '../../core/debug.js';
import { Http, http } from '../../platform/net/http.js';
import { hasAudioContext } from '../../platform/audio/capabilities.js';
import { Sound } from '../../platform/sound/sound.js';

/** @typedef {import('./handler.js').ResourceHandler} ResourceHandler */

// checks if user is running IE
const ie = function () {
  if (typeof window === 'undefined') {
    // Node.js => return false
    return false;
  }
  const ua = window.navigator.userAgent;
  const msie = ua.indexOf('MSIE ');
  if (msie > 0) {
    // IE 10 or older => return version number
    return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
  }
  const trident = ua.indexOf('Trident/');
  if (trident > 0) {
    // IE 11 => return version number
    const rv = ua.indexOf('rv:');
    return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
  }
  return false;
}();
const supportedExtensions = ['.ogg', '.mp3', '.wav', '.mp4a', '.m4a', '.mp4', '.aac', '.opus'];

/**
 * Resource handler used for loading {@link Sound} resources.
 *
 * @implements {ResourceHandler}
 * @category Sound
 */
class AudioHandler {
  /**
   * Create a new AudioHandler instance.
   *
   * @param {import('../app-base.js').AppBase} app - The running {@link AppBase}.
   * @hideconstructor
   */
  constructor(app) {
    /**
     * Type of the resource the handler handles.
     *
     * @type {string}
     */
    this.handlerType = "audio";
    this.manager = app.soundManager;
    Debug.assert(this.manager, "AudioSourceComponentSystem cannot be created without sound manager");
    this.maxRetries = 0;
  }
  _isSupported(url) {
    const ext = path.getExtension(url);
    return supportedExtensions.indexOf(ext) > -1;
  }
  load(url, callback) {
    if (typeof url === 'string') {
      url = {
        load: url,
        original: url
      };
    }
    const success = function success(resource) {
      callback(null, new Sound(resource));
    };
    const error = function error(err) {
      let msg = 'Error loading audio url: ' + url.original;
      if (err) {
        msg += ': ' + (err.message || err);
      }
      console.warn(msg);
      callback(msg);
    };
    if (this._createSound) {
      if (!this._isSupported(url.original)) {
        error(`Audio format for ${url.original} not supported`);
        return;
      }
      this._createSound(url.load, success, error);
    } else {
      error(null);
    }
  }
  open(url, data) {
    return data;
  }
  patch(asset, assets) {}

  /**
   * Loads an audio asset using an AudioContext by URL and calls success or error with the
   * created resource or error respectively.
   *
   * @param {string} url - The url of the audio asset.
   * @param {Function} success - Function to be called if the audio asset was loaded or if we
   * just want to continue without errors even if the audio is not loaded.
   * @param {Function} error - Function to be called if there was an error while loading the
   * audio asset.
   * @private
   */
  _createSound(url, success, error) {
    if (hasAudioContext()) {
      const manager = this.manager;
      if (!manager.context) {
        error('Audio manager has no audio context');
        return;
      }

      // if this is a blob URL we need to set the response type to arraybuffer
      const options = {
        retry: this.maxRetries > 0,
        maxRetries: this.maxRetries
      };
      if (url.startsWith('blob:') || url.startsWith('data:')) {
        options.responseType = Http.ResponseType.ARRAY_BUFFER;
      }
      http.get(url, options, function (err, response) {
        if (err) {
          error(err);
          return;
        }
        manager.context.decodeAudioData(response, success, error);
      });
    } else {
      let audio = null;
      try {
        audio = new Audio();
      } catch (e) {
        // Some windows platforms will report Audio as available, then throw an exception when
        // the object is created.
        error('No support for Audio element');
        return;
      }

      // audio needs to be added to the DOM for IE
      if (ie) {
        document.body.appendChild(audio);
      }
      const onReady = function onReady() {
        audio.removeEventListener('canplaythrough', onReady);

        // remove from DOM no longer necessary
        if (ie) {
          document.body.removeChild(audio);
        }
        success(audio);
      };
      audio.onerror = function () {
        audio.onerror = null;

        // remove from DOM no longer necessary
        if (ie) {
          document.body.removeChild(audio);
        }
        error();
      };
      audio.addEventListener('canplaythrough', onReady);
      audio.src = url;
    }
  }
}

export { AudioHandler };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVkaW8uanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9mcmFtZXdvcmsvaGFuZGxlcnMvYXVkaW8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGF0aCB9IGZyb20gJy4uLy4uL2NvcmUvcGF0aC5qcyc7XG5pbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4uLy4uL2NvcmUvZGVidWcuanMnO1xuXG5pbXBvcnQgeyBodHRwLCBIdHRwIH0gZnJvbSAnLi4vLi4vcGxhdGZvcm0vbmV0L2h0dHAuanMnO1xuXG5pbXBvcnQgeyBoYXNBdWRpb0NvbnRleHQgfSBmcm9tICcuLi8uLi9wbGF0Zm9ybS9hdWRpby9jYXBhYmlsaXRpZXMuanMnO1xuXG5pbXBvcnQgeyBTb3VuZCB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL3NvdW5kL3NvdW5kLmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4vaGFuZGxlci5qcycpLlJlc291cmNlSGFuZGxlcn0gUmVzb3VyY2VIYW5kbGVyICovXG5cbi8vIGNoZWNrcyBpZiB1c2VyIGlzIHJ1bm5pbmcgSUVcbmNvbnN0IGllID0gKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgLy8gTm9kZS5qcyA9PiByZXR1cm4gZmFsc2VcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCB1YSA9IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50O1xuXG4gICAgY29uc3QgbXNpZSA9IHVhLmluZGV4T2YoJ01TSUUgJyk7XG4gICAgaWYgKG1zaWUgPiAwKSB7XG4gICAgICAgIC8vIElFIDEwIG9yIG9sZGVyID0+IHJldHVybiB2ZXJzaW9uIG51bWJlclxuICAgICAgICByZXR1cm4gcGFyc2VJbnQodWEuc3Vic3RyaW5nKG1zaWUgKyA1LCB1YS5pbmRleE9mKCcuJywgbXNpZSkpLCAxMCk7XG4gICAgfVxuXG4gICAgY29uc3QgdHJpZGVudCA9IHVhLmluZGV4T2YoJ1RyaWRlbnQvJyk7XG4gICAgaWYgKHRyaWRlbnQgPiAwKSB7XG4gICAgICAgIC8vIElFIDExID0+IHJldHVybiB2ZXJzaW9uIG51bWJlclxuICAgICAgICBjb25zdCBydiA9IHVhLmluZGV4T2YoJ3J2OicpO1xuICAgICAgICByZXR1cm4gcGFyc2VJbnQodWEuc3Vic3RyaW5nKHJ2ICsgMywgdWEuaW5kZXhPZignLicsIHJ2KSksIDEwKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59KSgpO1xuXG5jb25zdCBzdXBwb3J0ZWRFeHRlbnNpb25zID0gW1xuICAgICcub2dnJyxcbiAgICAnLm1wMycsXG4gICAgJy53YXYnLFxuICAgICcubXA0YScsXG4gICAgJy5tNGEnLFxuICAgICcubXA0JyxcbiAgICAnLmFhYycsXG4gICAgJy5vcHVzJ1xuXTtcblxuLyoqXG4gKiBSZXNvdXJjZSBoYW5kbGVyIHVzZWQgZm9yIGxvYWRpbmcge0BsaW5rIFNvdW5kfSByZXNvdXJjZXMuXG4gKlxuICogQGltcGxlbWVudHMge1Jlc291cmNlSGFuZGxlcn1cbiAqIEBjYXRlZ29yeSBTb3VuZFxuICovXG5jbGFzcyBBdWRpb0hhbmRsZXIge1xuICAgIC8qKlxuICAgICAqIFR5cGUgb2YgdGhlIHJlc291cmNlIHRoZSBoYW5kbGVyIGhhbmRsZXMuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIGhhbmRsZXJUeXBlID0gXCJhdWRpb1wiO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IEF1ZGlvSGFuZGxlciBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9hcHAtYmFzZS5qcycpLkFwcEJhc2V9IGFwcCAtIFRoZSBydW5uaW5nIHtAbGluayBBcHBCYXNlfS5cbiAgICAgKiBAaGlkZWNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHRoaXMubWFuYWdlciA9IGFwcC5zb3VuZE1hbmFnZXI7XG4gICAgICAgIERlYnVnLmFzc2VydCh0aGlzLm1hbmFnZXIsIFwiQXVkaW9Tb3VyY2VDb21wb25lbnRTeXN0ZW0gY2Fubm90IGJlIGNyZWF0ZWQgd2l0aG91dCBzb3VuZCBtYW5hZ2VyXCIpO1xuXG4gICAgICAgIHRoaXMubWF4UmV0cmllcyA9IDA7XG4gICAgfVxuXG4gICAgX2lzU3VwcG9ydGVkKHVybCkge1xuICAgICAgICBjb25zdCBleHQgPSBwYXRoLmdldEV4dGVuc2lvbih1cmwpO1xuXG4gICAgICAgIHJldHVybiBzdXBwb3J0ZWRFeHRlbnNpb25zLmluZGV4T2YoZXh0KSA+IC0xO1xuICAgIH1cblxuICAgIGxvYWQodXJsLCBjYWxsYmFjaykge1xuICAgICAgICBpZiAodHlwZW9mIHVybCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHVybCA9IHtcbiAgICAgICAgICAgICAgICBsb2FkOiB1cmwsXG4gICAgICAgICAgICAgICAgb3JpZ2luYWw6IHVybFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBmdW5jdGlvbiAocmVzb3VyY2UpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIG5ldyBTb3VuZChyZXNvdXJjZSkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgbGV0IG1zZyA9ICdFcnJvciBsb2FkaW5nIGF1ZGlvIHVybDogJyArIHVybC5vcmlnaW5hbDtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBtc2cgKz0gJzogJyArIChlcnIubWVzc2FnZSB8fCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS53YXJuKG1zZyk7XG4gICAgICAgICAgICBjYWxsYmFjayhtc2cpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0aGlzLl9jcmVhdGVTb3VuZCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9pc1N1cHBvcnRlZCh1cmwub3JpZ2luYWwpKSB7XG4gICAgICAgICAgICAgICAgZXJyb3IoYEF1ZGlvIGZvcm1hdCBmb3IgJHt1cmwub3JpZ2luYWx9IG5vdCBzdXBwb3J0ZWRgKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZVNvdW5kKHVybC5sb2FkLCBzdWNjZXNzLCBlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlcnJvcihudWxsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9wZW4odXJsLCBkYXRhKSB7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIHBhdGNoKGFzc2V0LCBhc3NldHMpIHtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkcyBhbiBhdWRpbyBhc3NldCB1c2luZyBhbiBBdWRpb0NvbnRleHQgYnkgVVJMIGFuZCBjYWxscyBzdWNjZXNzIG9yIGVycm9yIHdpdGggdGhlXG4gICAgICogY3JlYXRlZCByZXNvdXJjZSBvciBlcnJvciByZXNwZWN0aXZlbHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIC0gVGhlIHVybCBvZiB0aGUgYXVkaW8gYXNzZXQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2VzcyAtIEZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBpZiB0aGUgYXVkaW8gYXNzZXQgd2FzIGxvYWRlZCBvciBpZiB3ZVxuICAgICAqIGp1c3Qgd2FudCB0byBjb250aW51ZSB3aXRob3V0IGVycm9ycyBldmVuIGlmIHRoZSBhdWRpbyBpcyBub3QgbG9hZGVkLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGVycm9yIC0gRnVuY3Rpb24gdG8gYmUgY2FsbGVkIGlmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBsb2FkaW5nIHRoZVxuICAgICAqIGF1ZGlvIGFzc2V0LlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2NyZWF0ZVNvdW5kKHVybCwgc3VjY2VzcywgZXJyb3IpIHtcbiAgICAgICAgaWYgKGhhc0F1ZGlvQ29udGV4dCgpKSB7XG4gICAgICAgICAgICBjb25zdCBtYW5hZ2VyID0gdGhpcy5tYW5hZ2VyO1xuXG4gICAgICAgICAgICBpZiAoIW1hbmFnZXIuY29udGV4dCkge1xuICAgICAgICAgICAgICAgIGVycm9yKCdBdWRpbyBtYW5hZ2VyIGhhcyBubyBhdWRpbyBjb250ZXh0Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGEgYmxvYiBVUkwgd2UgbmVlZCB0byBzZXQgdGhlIHJlc3BvbnNlIHR5cGUgdG8gYXJyYXlidWZmZXJcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgcmV0cnk6IHRoaXMubWF4UmV0cmllcyA+IDAsXG4gICAgICAgICAgICAgICAgbWF4UmV0cmllczogdGhpcy5tYXhSZXRyaWVzXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodXJsLnN0YXJ0c1dpdGgoJ2Jsb2I6JykgfHwgdXJsLnN0YXJ0c1dpdGgoJ2RhdGE6JykpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnJlc3BvbnNlVHlwZSA9IEh0dHAuUmVzcG9uc2VUeXBlLkFSUkFZX0JVRkZFUjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaHR0cC5nZXQodXJsLCBvcHRpb25zLCBmdW5jdGlvbiAoZXJyLCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1hbmFnZXIuY29udGV4dC5kZWNvZGVBdWRpb0RhdGEocmVzcG9uc2UsIHN1Y2Nlc3MsIGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IGF1ZGlvID0gbnVsbDtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhdWRpbyA9IG5ldyBBdWRpbygpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIFNvbWUgd2luZG93cyBwbGF0Zm9ybXMgd2lsbCByZXBvcnQgQXVkaW8gYXMgYXZhaWxhYmxlLCB0aGVuIHRocm93IGFuIGV4Y2VwdGlvbiB3aGVuXG4gICAgICAgICAgICAgICAgLy8gdGhlIG9iamVjdCBpcyBjcmVhdGVkLlxuICAgICAgICAgICAgICAgIGVycm9yKCdObyBzdXBwb3J0IGZvciBBdWRpbyBlbGVtZW50Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhdWRpbyBuZWVkcyB0byBiZSBhZGRlZCB0byB0aGUgRE9NIGZvciBJRVxuICAgICAgICAgICAgaWYgKGllKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhdWRpbyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IG9uUmVhZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXVkaW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCBvblJlYWR5KTtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBmcm9tIERPTSBubyBsb25nZXIgbmVjZXNzYXJ5XG4gICAgICAgICAgICAgICAgaWYgKGllKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYXVkaW8pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MoYXVkaW8pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXVkaW8ub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBhdWRpby5vbmVycm9yID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBmcm9tIERPTSBubyBsb25nZXIgbmVjZXNzYXJ5XG4gICAgICAgICAgICAgICAgaWYgKGllKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYXVkaW8pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGVycm9yKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhdWRpby5hZGRFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIG9uUmVhZHkpO1xuICAgICAgICAgICAgYXVkaW8uc3JjID0gdXJsO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgeyBBdWRpb0hhbmRsZXIgfTtcbiJdLCJuYW1lcyI6WyJpZSIsIndpbmRvdyIsInVhIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibXNpZSIsImluZGV4T2YiLCJwYXJzZUludCIsInN1YnN0cmluZyIsInRyaWRlbnQiLCJydiIsInN1cHBvcnRlZEV4dGVuc2lvbnMiLCJBdWRpb0hhbmRsZXIiLCJjb25zdHJ1Y3RvciIsImFwcCIsImhhbmRsZXJUeXBlIiwibWFuYWdlciIsInNvdW5kTWFuYWdlciIsIkRlYnVnIiwiYXNzZXJ0IiwibWF4UmV0cmllcyIsIl9pc1N1cHBvcnRlZCIsInVybCIsImV4dCIsInBhdGgiLCJnZXRFeHRlbnNpb24iLCJsb2FkIiwiY2FsbGJhY2siLCJvcmlnaW5hbCIsInN1Y2Nlc3MiLCJyZXNvdXJjZSIsIlNvdW5kIiwiZXJyb3IiLCJlcnIiLCJtc2ciLCJtZXNzYWdlIiwiY29uc29sZSIsIndhcm4iLCJfY3JlYXRlU291bmQiLCJvcGVuIiwiZGF0YSIsInBhdGNoIiwiYXNzZXQiLCJhc3NldHMiLCJoYXNBdWRpb0NvbnRleHQiLCJjb250ZXh0Iiwib3B0aW9ucyIsInJldHJ5Iiwic3RhcnRzV2l0aCIsInJlc3BvbnNlVHlwZSIsIkh0dHAiLCJSZXNwb25zZVR5cGUiLCJBUlJBWV9CVUZGRVIiLCJodHRwIiwiZ2V0IiwicmVzcG9uc2UiLCJkZWNvZGVBdWRpb0RhdGEiLCJhdWRpbyIsIkF1ZGlvIiwiZSIsImRvY3VtZW50IiwiYm9keSIsImFwcGVuZENoaWxkIiwib25SZWFkeSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZW1vdmVDaGlsZCIsIm9uZXJyb3IiLCJhZGRFdmVudExpc3RlbmVyIiwic3JjIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFTQTs7QUFFQTtBQUNBLE1BQU1BLEVBQUUsR0FBSSxZQUFZO0FBQ3BCLEVBQUEsSUFBSSxPQUFPQyxNQUFNLEtBQUssV0FBVyxFQUFFO0FBQy9CO0FBQ0EsSUFBQSxPQUFPLEtBQUssQ0FBQTtBQUNoQixHQUFBO0FBQ0EsRUFBQSxNQUFNQyxFQUFFLEdBQUdELE1BQU0sQ0FBQ0UsU0FBUyxDQUFDQyxTQUFTLENBQUE7QUFFckMsRUFBQSxNQUFNQyxJQUFJLEdBQUdILEVBQUUsQ0FBQ0ksT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0VBQ2hDLElBQUlELElBQUksR0FBRyxDQUFDLEVBQUU7QUFDVjtJQUNBLE9BQU9FLFFBQVEsQ0FBQ0wsRUFBRSxDQUFDTSxTQUFTLENBQUNILElBQUksR0FBRyxDQUFDLEVBQUVILEVBQUUsQ0FBQ0ksT0FBTyxDQUFDLEdBQUcsRUFBRUQsSUFBSSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQTtBQUN0RSxHQUFBO0FBRUEsRUFBQSxNQUFNSSxPQUFPLEdBQUdQLEVBQUUsQ0FBQ0ksT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFBO0VBQ3RDLElBQUlHLE9BQU8sR0FBRyxDQUFDLEVBQUU7QUFDYjtBQUNBLElBQUEsTUFBTUMsRUFBRSxHQUFHUixFQUFFLENBQUNJLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUM1QixPQUFPQyxRQUFRLENBQUNMLEVBQUUsQ0FBQ00sU0FBUyxDQUFDRSxFQUFFLEdBQUcs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
