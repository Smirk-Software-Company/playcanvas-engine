import { path } from '../../core/path.js';
import { TEXTURETYPE_RGBM, TEXTURETYPE_SWIZZLEGGGR, PIXELFORMAT_RGB8, ADDRESS_REPEAT, ADDRESS_CLAMP_TO_EDGE, ADDRESS_MIRRORED_REPEAT, FILTER_NEAREST, FILTER_LINEAR, FILTER_NEAREST_MIPMAP_NEAREST, FILTER_LINEAR_MIPMAP_NEAREST, FILTER_NEAREST_MIPMAP_LINEAR, FILTER_LINEAR_MIPMAP_LINEAR, TEXTURETYPE_DEFAULT, TEXTURETYPE_RGBE, TEXTURETYPE_RGBP, PIXELFORMAT_RGBA8, PIXELFORMAT_RGBA32F, TEXHINT_ASSET } from '../../platform/graphics/constants.js';
import { Texture } from '../../platform/graphics/texture.js';
import { BasisParser } from '../parsers/texture/basis.js';
import { ImgParser } from '../parsers/texture/img.js';
import { KtxParser } from '../parsers/texture/ktx.js';
import { Ktx2Parser } from '../parsers/texture/ktx2.js';
import { DdsParser } from '../parsers/texture/dds.js';
import { HdrParser } from '../parsers/texture/hdr.js';

/** @typedef {import('./handler.js').ResourceHandler} ResourceHandler */

const JSON_ADDRESS_MODE = {
  'repeat': ADDRESS_REPEAT,
  'clamp': ADDRESS_CLAMP_TO_EDGE,
  'mirror': ADDRESS_MIRRORED_REPEAT
};
const JSON_FILTER_MODE = {
  'nearest': FILTER_NEAREST,
  'linear': FILTER_LINEAR,
  'nearest_mip_nearest': FILTER_NEAREST_MIPMAP_NEAREST,
  'linear_mip_nearest': FILTER_LINEAR_MIPMAP_NEAREST,
  'nearest_mip_linear': FILTER_NEAREST_MIPMAP_LINEAR,
  'linear_mip_linear': FILTER_LINEAR_MIPMAP_LINEAR
};
const JSON_TEXTURE_TYPE = {
  'default': TEXTURETYPE_DEFAULT,
  'rgbm': TEXTURETYPE_RGBM,
  'rgbe': TEXTURETYPE_RGBE,
  'rgbp': TEXTURETYPE_RGBP,
  'swizzleGGGR': TEXTURETYPE_SWIZZLEGGGR
};

/**
 * @interface
 * @name TextureParser
 * @description Interface to a texture parser. Implementations of this interface handle the loading
 * and opening of texture assets.
 *
 * @category Graphics
 */
class TextureParser {
  /* eslint-disable jsdoc/require-returns-check */
  /**
   * @function
   * @name TextureParser#load
   * @description Load the texture from the remote URL. When loaded (or failed),
   * use the callback to return an the raw resource data (or error).
   * @param {object} url - The URL of the resource to load.
   * @param {string} url.load - The URL to use for loading the resource.
   * @param {string} url.original - The original URL useful for identifying the resource type.
   * @param {import('./handler.js').ResourceHandlerCallback} callback - The callback used when
   * the resource is loaded or an error occurs.
   * @param {import('../asset/asset.js').Asset} [asset] - Optional asset that is passed by
   * ResourceLoader.
   */
  load(url, callback, asset) {
    throw new Error('not implemented');
  }

  /**
   * @function
   * @name TextureParser#open
   * @description Convert raw resource data into a resource instance. E.g. Take 3D model format
   * JSON and return a {@link Model}.
   * @param {string} url - The URL of the resource to open.
   * @param {*} data - The raw resource data passed by callback from {@link ResourceHandler#load}.
   * @param {import('../../platform/graphics/graphics-device.js').GraphicsDevice} device - The
   * graphics device.
   * @returns {Texture} The parsed resource data.
   */
  open(url, data, device) {
    throw new Error('not implemented');
  }
  /* eslint-enable jsdoc/require-returns-check */
}

// In the case where a texture has more than 1 level of mip data specified, but not the full
// mip chain, we generate the missing levels here.
// This is to overcome an issue where iphone xr and xs ignores further updates to the mip data
// after invoking gl.generateMipmap on the texture (which was the previous method of ensuring
// the texture's full mip chain was complete).
// NOTE: this function only resamples RGBA8 and RGBAFloat32 data.
const _completePartialMipmapChain = function _completePartialMipmapChain(texture) {
  const requiredMipLevels = Math.log2(Math.max(texture._width, texture._height)) + 1;
  const isHtmlElement = function isHtmlElement(object) {
    return object instanceof HTMLCanvasElement || object instanceof HTMLImageElement || object instanceof HTMLVideoElement;
  };
  if (!(texture._format === PIXELFORMAT_RGBA8 || texture._format === PIXELFORMAT_RGBA32F) || texture._volume || texture._compressed || texture._levels.length === 1 || texture._levels.length === requiredMipLevels || isHtmlElement(texture._cubemap ? texture._levels[0][0] : texture._levels[0])) {
    return;
  }
  const downsample = function downsample(width, height, data) {
    const sampledWidth = Math.max(1, width >> 1);
    const sampledHeight = Math.max(1, height >> 1);
    const sampledData = new data.constructor(sampledWidth * sampledHeight * 4);
    const xs = Math.floor(width / sampledWidth);
    const ys = Math.floor(height / sampledHeight);
    const xsys = xs * ys;
    for (let y = 0; y < sampledHeight; ++y) {
      for (let x = 0; x < sampledWidth; ++x) {
        for (let e = 0; e < 4; ++e) {
          let sum = 0;
          for (let sy = 0; sy < ys; ++sy) {
            for (let sx = 0; sx < xs; ++sx) {
              sum += data[(x * xs + sx + (y * ys + sy) * width) * 4 + e];
            }
          }
          sampledData[(x + y * sampledWidth) * 4 + e] = sum / xsys;
        }
      }
    }
    return sampledData;
  };

  // step through levels
  for (let level = texture._levels.length; level < requiredMipLevels; ++level) {
    const width = Math.max(1, texture._width >> level - 1);
    const height = Math.max(1, texture._height >> level - 1);
    if (texture._cubemap) {
      const mips = [];
      for (let face = 0; face < 6; ++face) {
        mips.push(downsample(width, height, texture._levels[level - 1][face]));
      }
      texture._levels.push(mips);
    } else {
      texture._levels.push(downsample(width, height, texture._levels[level - 1]));
    }
  }
  texture._levelsUpdated = texture._cubemap ? [[true, true, true, true, true, true]] : [true];
};

/**
 * Resource handler used for loading 2D and 3D {@link Texture} resources.
 *
 * @implements {ResourceHandler}
 * @category Graphics
 */
class TextureHandler {
  /**
   * Create a new TextureHandler instance.
   *
   * @param {import('../app-base.js').AppBase} app - The running {@link AppBase}.
   * @hideconstructor
   */
  constructor(app) {
    /**
     * Type of the resource the handler handles.
     *
     * @type {string}
     */
    this.handlerType = "texture";
    const assets = app.assets;
    const device = app.graphicsDevice;
    this._device = device;
    this._assets = assets;

    // img parser handles all browser-supported image formats, this
    // parser will be used when other more specific parsers are not found.
    this.imgParser = new ImgParser(assets, device);
    this.parsers = {
      dds: new DdsParser(assets),
      ktx: new KtxParser(assets),
      ktx2: new Ktx2Parser(assets, device),
      basis: new BasisParser(assets, device),
      hdr: new HdrParser(assets)
    };
  }
  set crossOrigin(value) {
    this.imgParser.crossOrigin = value;
  }
  get crossOrigin() {
    return this.imgParser.crossOrigin;
  }
  set maxRetries(value) {
    this.imgParser.maxRetries = value;
    for (const parser in this.parsers) {
      if (this.parsers.hasOwnProperty(parser)) {
        this.parsers[parser].maxRetries = value;
      }
    }
  }
  get maxRetries() {
    return this.imgParser.maxRetries;
  }
  _getUrlWithoutParams(url) {
    return url.indexOf('?') >= 0 ? url.split('?')[0] : url;
  }
  _getParser(url) {
    const ext = path.getExtension(this._getUrlWithoutParams(url)).toLowerCase().replace('.', '');
    return this.parsers[ext] || this.imgParser;
  }
  _getTextureOptions(asset) {
    const options = {
      profilerHint: TEXHINT_ASSET
    };
    if (asset) {
      var _asset$name;
      if (((_asset$name = asset.name) == null ? void 0 : _asset$name.length) > 0) {
        options.name = asset.name;
      }
      const assetData = asset.data;
      if (assetData.hasOwnProperty('minfilter')) {
        options.minFilter = JSON_FILTER_MODE[assetData.minfilter];
      }
      if (assetData.hasOwnProperty('magfilter')) {
        options.magFilter = JSON_FILTER_MODE[assetData.magfilter];
      }
      if (assetData.hasOwnProperty('addressu')) {
        options.addressU = JSON_ADDRESS_MODE[assetData.addressu];
      }
      if (assetData.hasOwnProperty('addressv')) {
        options.addressV = JSON_ADDRESS_MODE[assetData.addressv];
      }
      if (assetData.hasOwnProperty('mipmaps')) {
        options.mipmaps = assetData.mipmaps;
      }
      if (assetData.hasOwnProperty('anisotropy')) {
        options.anisotropy = assetData.anisotropy;
      }
      if (assetData.hasOwnProperty('flipY')) {
        options.flipY = !!assetData.flipY;
      }

      // extract asset type (this is bit of a mess)
      if (assetData.hasOwnProperty('type')) {
        options.type = JSON_TEXTURE_TYPE[assetData.type];
      } else if (assetData.hasOwnProperty('rgbm') && assetData.rgbm) {
        options.type = TEXTURETYPE_RGBM;
      } else if (asset.file && (asset.file.opt & 8) !== 0) {
        // basis normalmaps flag the variant as swizzled
        options.type = TEXTURETYPE_SWIZZLEGGGR;
      }
    }
    return options;
  }
  load(url, callback, asset) {
    if (typeof url === 'string') {
      url = {
        load: url,
        original: url
      };
    }
    this._getParser(url.original).load(url, callback, asset);
  }
  open(url, data, asset) {
    if (!url) return undefined;
    const textureOptions = this._getTextureOptions(asset);
    let texture = this._getParser(url).open(url, data, this._device, textureOptions);
    if (texture === null) {
      texture = new Texture(this._device, {
        width: 4,
        height: 4,
        format: PIXELFORMAT_RGB8
      });
    } else {
      // check if the texture has only a partial mipmap chain specified and generate the
      // missing levels if possible.
      _completePartialMipmapChain(texture);

      // if the basis transcoder unswizzled a GGGR texture, remove the flag from the asset
      if (data.unswizzledGGGR) {
        asset.file.variants.basis.opt &= ~8;
      }
    }
    return texture;
  }
  patch(asset, assets) {
    const texture = asset.resource;
    if (!texture) {
      return;
    }

    // apply asset options, based on asset.data
    const options = this._getTextureOptions(asset);
    for (const key of Object.keys(options)) {
      texture[key] = options[key];
    }
  }
}

export { TextureHandler, TextureParser };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV4dHVyZS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2ZyYW1ld29yay9oYW5kbGVycy90ZXh0dXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhdGggfSBmcm9tICcuLi8uLi9jb3JlL3BhdGguanMnO1xuXG5pbXBvcnQge1xuICAgIFRFWEhJTlRfQVNTRVQsXG4gICAgQUREUkVTU19DTEFNUF9UT19FREdFLCBBRERSRVNTX01JUlJPUkVEX1JFUEVBVCwgQUREUkVTU19SRVBFQVQsXG4gICAgRklMVEVSX0xJTkVBUiwgRklMVEVSX05FQVJFU1QsIEZJTFRFUl9ORUFSRVNUX01JUE1BUF9ORUFSRVNULCBGSUxURVJfTkVBUkVTVF9NSVBNQVBfTElORUFSLCBGSUxURVJfTElORUFSX01JUE1BUF9ORUFSRVNULCBGSUxURVJfTElORUFSX01JUE1BUF9MSU5FQVIsXG4gICAgUElYRUxGT1JNQVRfUkdCOCwgUElYRUxGT1JNQVRfUkdCQTgsIFBJWEVMRk9STUFUX1JHQkEzMkYsXG4gICAgVEVYVFVSRVRZUEVfREVGQVVMVCwgVEVYVFVSRVRZUEVfUkdCRSwgVEVYVFVSRVRZUEVfUkdCTSwgVEVYVFVSRVRZUEVfU1dJWlpMRUdHR1IsIFRFWFRVUkVUWVBFX1JHQlBcbn0gZnJvbSAnLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3MvY29uc3RhbnRzLmpzJztcbmltcG9ydCB7IFRleHR1cmUgfSBmcm9tICcuLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy90ZXh0dXJlLmpzJztcblxuaW1wb3J0IHsgQmFzaXNQYXJzZXIgfSBmcm9tICcuLi9wYXJzZXJzL3RleHR1cmUvYmFzaXMuanMnO1xuaW1wb3J0IHsgSW1nUGFyc2VyIH0gZnJvbSAnLi4vcGFyc2Vycy90ZXh0dXJlL2ltZy5qcyc7XG5pbXBvcnQgeyBLdHhQYXJzZXIgfSBmcm9tICcuLi9wYXJzZXJzL3RleHR1cmUva3R4LmpzJztcbmltcG9ydCB7IEt0eDJQYXJzZXIgfSBmcm9tICcuLi9wYXJzZXJzL3RleHR1cmUva3R4Mi5qcyc7XG5pbXBvcnQgeyBEZHNQYXJzZXIgfSBmcm9tICcuLi9wYXJzZXJzL3RleHR1cmUvZGRzLmpzJztcbmltcG9ydCB7IEhkclBhcnNlciB9IGZyb20gJy4uL3BhcnNlcnMvdGV4dHVyZS9oZHIuanMnO1xuXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi9oYW5kbGVyLmpzJykuUmVzb3VyY2VIYW5kbGVyfSBSZXNvdXJjZUhhbmRsZXIgKi9cblxuY29uc3QgSlNPTl9BRERSRVNTX01PREUgPSB7XG4gICAgJ3JlcGVhdCc6IEFERFJFU1NfUkVQRUFULFxuICAgICdjbGFtcCc6IEFERFJFU1NfQ0xBTVBfVE9fRURHRSxcbiAgICAnbWlycm9yJzogQUREUkVTU19NSVJST1JFRF9SRVBFQVRcbn07XG5cbmNvbnN0IEpTT05fRklMVEVSX01PREUgPSB7XG4gICAgJ25lYXJlc3QnOiBGSUxURVJfTkVBUkVTVCxcbiAgICAnbGluZWFyJzogRklMVEVSX0xJTkVBUixcbiAgICAnbmVhcmVzdF9taXBfbmVhcmVzdCc6IEZJTFRFUl9ORUFSRVNUX01JUE1BUF9ORUFSRVNULFxuICAgICdsaW5lYXJfbWlwX25lYXJlc3QnOiBGSUxURVJfTElORUFSX01JUE1BUF9ORUFSRVNULFxuICAgICduZWFyZXN0X21pcF9saW5lYXInOiBGSUxURVJfTkVBUkVTVF9NSVBNQVBfTElORUFSLFxuICAgICdsaW5lYXJfbWlwX2xpbmVhcic6IEZJTFRFUl9MSU5FQVJfTUlQTUFQX0xJTkVBUlxufTtcblxuY29uc3QgSlNPTl9URVhUVVJFX1RZUEUgPSB7XG4gICAgJ2RlZmF1bHQnOiBURVhUVVJFVFlQRV9ERUZBVUxULFxuICAgICdyZ2JtJzogVEVYVFVSRVRZUEVfUkdCTSxcbiAgICAncmdiZSc6IFRFWFRVUkVUWVBFX1JHQkUsXG4gICAgJ3JnYnAnOiBURVhUVVJFVFlQRV9SR0JQLFxuICAgICdzd2l6emxlR0dHUic6IFRFWFRVUkVUWVBFX1NXSVpaTEVHR0dSXG59O1xuXG4vKipcbiAqIEBpbnRlcmZhY2VcbiAqIEBuYW1lIFRleHR1cmVQYXJzZXJcbiAqIEBkZXNjcmlwdGlvbiBJbnRlcmZhY2UgdG8gYSB0ZXh0dXJlIHBhcnNlci4gSW1wbGVtZW50YXRpb25zIG9mIHRoaXMgaW50ZXJmYWNlIGhhbmRsZSB0aGUgbG9hZGluZ1xuICogYW5kIG9wZW5pbmcgb2YgdGV4dHVyZSBhc3NldHMuXG4gKlxuICogQGNhdGVnb3J5IEdyYXBoaWNzXG4gKi9cbmNsYXNzIFRleHR1cmVQYXJzZXIge1xuICAgIC8qIGVzbGludC1kaXNhYmxlIGpzZG9jL3JlcXVpcmUtcmV0dXJucy1jaGVjayAqL1xuICAgIC8qKlxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBuYW1lIFRleHR1cmVQYXJzZXIjbG9hZFxuICAgICAqIEBkZXNjcmlwdGlvbiBMb2FkIHRoZSB0ZXh0dXJlIGZyb20gdGhlIHJlbW90ZSBVUkwuIFdoZW4gbG9hZGVkIChvciBmYWlsZWQpLFxuICAgICAqIHVzZSB0aGUgY2FsbGJhY2sgdG8gcmV0dXJuIGFuIHRoZSByYXcgcmVzb3VyY2UgZGF0YSAob3IgZXJyb3IpLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSB1cmwgLSBUaGUgVVJMIG9mIHRoZSByZXNvdXJjZSB0byBsb2FkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwubG9hZCAtIFRoZSBVUkwgdG8gdXNlIGZvciBsb2FkaW5nIHRoZSByZXNvdXJjZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsLm9yaWdpbmFsIC0gVGhlIG9yaWdpbmFsIFVSTCB1c2VmdWwgZm9yIGlkZW50aWZ5aW5nIHRoZSByZXNvdXJjZSB0eXBlLlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuL2hhbmRsZXIuanMnKS5SZXNvdXJjZUhhbmRsZXJDYWxsYmFja30gY2FsbGJhY2sgLSBUaGUgY2FsbGJhY2sgdXNlZCB3aGVuXG4gICAgICogdGhlIHJlc291cmNlIGlzIGxvYWRlZCBvciBhbiBlcnJvciBvY2N1cnMuXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4uL2Fzc2V0L2Fzc2V0LmpzJykuQXNzZXR9IFthc3NldF0gLSBPcHRpb25hbCBhc3NldCB0aGF0IGlzIHBhc3NlZCBieVxuICAgICAqIFJlc291cmNlTG9hZGVyLlxuICAgICAqL1xuICAgIGxvYWQodXJsLCBjYWxsYmFjaywgYXNzZXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdub3QgaW1wbGVtZW50ZWQnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAbmFtZSBUZXh0dXJlUGFyc2VyI29wZW5cbiAgICAgKiBAZGVzY3JpcHRpb24gQ29udmVydCByYXcgcmVzb3VyY2UgZGF0YSBpbnRvIGEgcmVzb3VyY2UgaW5zdGFuY2UuIEUuZy4gVGFrZSAzRCBtb2RlbCBmb3JtYXRcbiAgICAgKiBKU09OIGFuZCByZXR1cm4gYSB7QGxpbmsgTW9kZWx9LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBUaGUgVVJMIG9mIHRoZSByZXNvdXJjZSB0byBvcGVuLlxuICAgICAqIEBwYXJhbSB7Kn0gZGF0YSAtIFRoZSByYXcgcmVzb3VyY2UgZGF0YSBwYXNzZWQgYnkgY2FsbGJhY2sgZnJvbSB7QGxpbmsgUmVzb3VyY2VIYW5kbGVyI2xvYWR9LlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy9ncmFwaGljcy1kZXZpY2UuanMnKS5HcmFwaGljc0RldmljZX0gZGV2aWNlIC0gVGhlXG4gICAgICogZ3JhcGhpY3MgZGV2aWNlLlxuICAgICAqIEByZXR1cm5zIHtUZXh0dXJlfSBUaGUgcGFyc2VkIHJlc291cmNlIGRhdGEuXG4gICAgICovXG4gICAgb3Blbih1cmwsIGRhdGEsIGRldmljZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ25vdCBpbXBsZW1lbnRlZCcpO1xuICAgIH1cbiAgICAvKiBlc2xpbnQtZW5hYmxlIGpzZG9jL3JlcXVpcmUtcmV0dXJucy1jaGVjayAqL1xufVxuXG4vLyBJbiB0aGUgY2FzZSB3aGVyZSBhIHRleHR1cmUgaGFzIG1vcmUgdGhhbiAxIGxldmVsIG9mIG1pcCBkYXRhIHNwZWNpZmllZCwgYnV0IG5vdCB0aGUgZnVsbFxuLy8gbWlwIGNoYWluLCB3ZSBnZW5lcmF0ZSB0aGUgbWlzc2luZyBsZXZlbHMgaGVyZS5cbi8vIFRoaXMgaXMgdG8gb3ZlcmNvbWUgYW4gaXNzdWUgd2hlcmUgaXBob25lIHhyIGFuZCB4cyBpZ25vcmVzIGZ1cnRoZXIgdXBkYXRlcyB0byB0aGUgbWlwIGRhdGFcbi8vIGFmdGVyIGludm9raW5nIGdsLmdlbmVyYXRlTWlwbWFwIG9uIHRoZSB0ZXh0dXJlICh3aGljaCB3YXMgdGhlIHByZXZpb3VzIG1ldGhvZCBvZiBlbnN1cmluZ1xuLy8gdGhlIHRleHR1cmUncyBmdWxsIG1pcCBjaGFpbiB3YXMgY29tcGxldGUpLlxuLy8gTk9URTogdGhpcyBmdW5jdGlvbiBvbmx5IHJlc2FtcGxlcyBSR0JBOCBhbmQgUkdCQUZsb2F0MzIgZGF0YS5cbmNvbnN0IF9jb21wbGV0ZVBhcnRpYWxNaXBtYXBDaGFpbiA9IGZ1bmN0aW9uICh0ZXh0dXJlKSB7XG5cbiAgICBjb25zdCByZXF1aXJlZE1pcExldmVscyA9IE1hdGgubG9nMihNYXRoLm1heCh0ZXh0dXJlLl93aWR0aCwgdGV4dHVyZS5faGVpZ2h0KSkgKyAxO1xuXG4gICAgY29uc3QgaXNIdG1sRWxlbWVudCA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIChvYmplY3QgaW5zdGFuY2VvZiBIVE1MQ2FudmFzRWxlbWVudCkgfHxcbiAgICAgICAgICAgICAgIChvYmplY3QgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50KSB8fFxuICAgICAgICAgICAgICAgKG9iamVjdCBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQpO1xuICAgIH07XG5cbiAgICBpZiAoISh0ZXh0dXJlLl9mb3JtYXQgPT09IFBJWEVMRk9STUFUX1JHQkE4IHx8XG4gICAgICAgICAgdGV4dHVyZS5fZm9ybWF0ID09PSBQSVhFTEZPUk1BVF9SR0JBMzJGKSB8fFxuICAgICAgICAgIHRleHR1cmUuX3ZvbHVtZSB8fFxuICAgICAgICAgIHRleHR1cmUuX2NvbXByZXNzZWQgfHxcbiAgICAgICAgICB0ZXh0dXJlLl9sZXZlbHMubGVuZ3RoID09PSAxIHx8XG4gICAgICAgICAgdGV4dHVyZS5fbGV2ZWxzLmxlbmd0aCA9PT0gcmVxdWlyZWRNaXBMZXZlbHMgfHxcbiAgICAgICAgICBpc0h0bWxFbGVtZW50KHRleHR1cmUuX2N1YmVtYXAgPyB0ZXh0dXJlLl9sZXZlbHNbMF1bMF0gOiB0ZXh0dXJlLl9sZXZlbHNbMF0pKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBkb3duc2FtcGxlID0gZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIGRhdGEpIHtcbiAgICAgICAgY29uc3Qgc2FtcGxlZFdpZHRoID0gTWF0aC5tYXgoMSwgd2lkdGggPj4gMSk7XG4gICAgICAgIGNvbnN0IHNhbXBsZWRIZWlnaHQgPSBNYXRoLm1heCgxLCBoZWlnaHQgPj4gMSk7XG4gICAgICAgIGNvbnN0IHNhbXBsZWREYXRhID0gbmV3IGRhdGEuY29uc3RydWN0b3Ioc2FtcGxlZFdpZHRoICogc2FtcGxlZEhlaWdodCAqIDQpO1xuXG4gICAgICAgIGNvbnN0IHhzID0gTWF0aC5mbG9vcih3aWR0aCAvIHNhbXBsZWRXaWR0aCk7XG4gICAgICAgIGNvbnN0IHlzID0gTWF0aC5mbG9vcihoZWlnaHQgLyBzYW1wbGVkSGVpZ2h0KTtcbiAgICAgICAgY29uc3QgeHN5cyA9IHhzICogeXM7XG5cbiAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCBzYW1wbGVkSGVpZ2h0OyArK3kpIHtcbiAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgc2FtcGxlZFdpZHRoOyArK3gpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IDQ7ICsrZSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3VtID0gMDtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgc3kgPSAwOyBzeSA8IHlzOyArK3N5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBzeCA9IDA7IHN4IDwgeHM7ICsrc3gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdW0gKz0gZGF0YVsoeCAqIHhzICsgc3ggKyAoeSAqIHlzICsgc3kpICogd2lkdGgpICogNCArIGVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNhbXBsZWREYXRhWyh4ICsgeSAqIHNhbXBsZWRXaWR0aCkgKiA0ICsgZV0gPSBzdW0gLyB4c3lzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzYW1wbGVkRGF0YTtcbiAgICB9O1xuXG4gICAgLy8gc3RlcCB0aHJvdWdoIGxldmVsc1xuICAgIGZvciAobGV0IGxldmVsID0gdGV4dHVyZS5fbGV2ZWxzLmxlbmd0aDsgbGV2ZWwgPCByZXF1aXJlZE1pcExldmVsczsgKytsZXZlbCkge1xuICAgICAgICBjb25zdCB3aWR0aCA9IE1hdGgubWF4KDEsIHRleHR1cmUuX3dpZHRoID4+IChsZXZlbCAtIDEpKTtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gTWF0aC5tYXgoMSwgdGV4dHVyZS5faGVpZ2h0ID4+IChsZXZlbCAtIDEpKTtcbiAgICAgICAgaWYgKHRleHR1cmUuX2N1YmVtYXApIHtcbiAgICAgICAgICAgIGNvbnN0IG1pcHMgPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgNjsgKytmYWNlKSB7XG4gICAgICAgICAgICAgICAgbWlwcy5wdXNoKGRvd25zYW1wbGUod2lkdGgsIGhlaWdodCwgdGV4dHVyZS5fbGV2ZWxzW2xldmVsIC0gMV1bZmFjZV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRleHR1cmUuX2xldmVscy5wdXNoKG1pcHMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGV4dHVyZS5fbGV2ZWxzLnB1c2goZG93bnNhbXBsZSh3aWR0aCwgaGVpZ2h0LCB0ZXh0dXJlLl9sZXZlbHNbbGV2ZWwgLSAxXSkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGV4dHVyZS5fbGV2ZWxzVXBkYXRlZCA9IHRleHR1cmUuX2N1YmVtYXAgPyBbW3RydWUsIHRydWUsIHRydWUsIHRydWUsIHRydWUsIHRydWVdXSA6IFt0cnVlXTtcbn07XG5cbi8qKlxuICogUmVzb3VyY2UgaGFuZGxlciB1c2VkIGZvciBsb2FkaW5nIDJEIGFuZCAzRCB7QGxpbmsgVGV4dHVyZX0gcmVzb3VyY2VzLlxuICpcbiAqIEBpbXBsZW1lbnRzIHtSZXNvdXJjZUhhbmRsZXJ9XG4gKiBAY2F0ZWdvcnkgR3JhcGhpY3NcbiAqL1xuY2xhc3MgVGV4dHVyZUhhbmRsZXIge1xuICAgIC8qKlxuICAgICAqIFR5cGUgb2YgdGhlIHJlc291cmNlIHRoZSBoYW5kbGVyIGhhbmRsZXMuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIGhhbmRsZXJUeXBlID0gXCJ0ZXh0dXJlXCI7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgVGV4dHVyZUhhbmRsZXIgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vYXBwLWJhc2UuanMnKS5BcHBCYXNlfSBhcHAgLSBUaGUgcnVubmluZyB7QGxpbmsgQXBwQmFzZX0uXG4gICAgICogQGhpZGVjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICBjb25zdCBhc3NldHMgPSBhcHAuYXNzZXRzO1xuICAgICAgICBjb25zdCBkZXZpY2UgPSBhcHAuZ3JhcGhpY3NEZXZpY2U7XG5cbiAgICAgICAgdGhpcy5fZGV2aWNlID0gZGV2aWNlO1xuICAgICAgICB0aGlzLl9hc3NldHMgPSBhc3NldHM7XG5cbiAgICAgICAgLy8gaW1nIHBhcnNlciBoYW5kbGVzIGFsbCBicm93c2VyLXN1cHBvcnRlZCBpbWFnZSBmb3JtYXRzLCB0aGlzXG4gICAgICAgIC8vIHBhcnNlciB3aWxsIGJlIHVzZWQgd2hlbiBvdGhlciBtb3JlIHNwZWNpZmljIHBhcnNlcnMgYXJlIG5vdCBmb3VuZC5cbiAgICAgICAgdGhpcy5pbWdQYXJzZXIgPSBuZXcgSW1nUGFyc2VyKGFzc2V0cywgZGV2aWNlKTtcblxuICAgICAgICB0aGlzLnBhcnNlcnMgPSB7XG4gICAgICAgICAgICBkZHM6IG5ldyBEZHNQYXJzZXIoYXNzZXRzKSxcbiAgICAgICAgICAgIGt0eDogbmV3IEt0eFBhcnNlcihhc3NldHMpLFxuICAgICAgICAgICAga3R4MjogbmV3IEt0eDJQYXJzZXIoYXNzZXRzLCBkZXZpY2UpLFxuICAgICAgICAgICAgYmFzaXM6IG5ldyBCYXNpc1BhcnNlcihhc3NldHMsIGRldmljZSksXG4gICAgICAgICAgICBoZHI6IG5ldyBIZHJQYXJzZXIoYXNzZXRzKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHNldCBjcm9zc09yaWdpbih2YWx1ZSkge1xuICAgICAgICB0aGlzLmltZ1BhcnNlci5jcm9zc09yaWdpbiA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdldCBjcm9zc09yaWdpbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW1nUGFyc2VyLmNyb3NzT3JpZ2luO1xuICAgIH1cblxuICAgIHNldCBtYXhSZXRyaWVzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuaW1nUGFyc2VyLm1heFJldHJpZXMgPSB2YWx1ZTtcbiAgICAgICAgZm9yIChjb25zdCBwYXJzZXIgaW4gdGhpcy5wYXJzZXJzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJzZXJzLmhhc093blByb3BlcnR5KHBhcnNlcikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcnNlcnNbcGFyc2VyXS5tYXhSZXRyaWVzID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgbWF4UmV0cmllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW1nUGFyc2VyLm1heFJldHJpZXM7XG4gICAgfVxuXG4gICAgX2dldFVybFdpdGhvdXRQYXJhbXModXJsKSB7XG4gICAgICAgIHJldHVybiB1cmwuaW5kZXhPZignPycpID49IDAgPyB1cmwuc3BsaXQoJz8nKVswXSA6IHVybDtcbiAgICB9XG5cbiAgICBfZ2V0UGFyc2VyKHVybCkge1xuICAgICAgICBjb25zdCBleHQgPSBwYXRoLmdldEV4dGVuc2lvbih0aGlzLl9nZXRVcmxXaXRob3V0UGFyYW1zKHVybCkpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgnLicsICcnKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2Vyc1tleHRdIHx8IHRoaXMuaW1nUGFyc2VyO1xuICAgIH1cblxuICAgIF9nZXRUZXh0dXJlT3B0aW9ucyhhc3NldCkge1xuXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAvLyAjaWYgX1BST0ZJTEVSXG4gICAgICAgICAgICBwcm9maWxlckhpbnQ6IFRFWEhJTlRfQVNTRVRcbiAgICAgICAgICAgIC8vICNlbmRpZlxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChhc3NldCkge1xuICAgICAgICAgICAgaWYgKGFzc2V0Lm5hbWU/Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLm5hbWUgPSBhc3NldC5uYW1lO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBhc3NldERhdGEgPSBhc3NldC5kYXRhO1xuXG4gICAgICAgICAgICBpZiAoYXNzZXREYXRhLmhhc093blByb3BlcnR5KCdtaW5maWx0ZXInKSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMubWluRmlsdGVyID0gSlNPTl9GSUxURVJfTU9ERVthc3NldERhdGEubWluZmlsdGVyXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGFzc2V0RGF0YS5oYXNPd25Qcm9wZXJ0eSgnbWFnZmlsdGVyJykpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLm1hZ0ZpbHRlciA9IEpTT05fRklMVEVSX01PREVbYXNzZXREYXRhLm1hZ2ZpbHRlcl07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhc3NldERhdGEuaGFzT3duUHJvcGVydHkoJ2FkZHJlc3N1JykpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmFkZHJlc3NVID0gSlNPTl9BRERSRVNTX01PREVbYXNzZXREYXRhLmFkZHJlc3N1XTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGFzc2V0RGF0YS5oYXNPd25Qcm9wZXJ0eSgnYWRkcmVzc3YnKSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuYWRkcmVzc1YgPSBKU09OX0FERFJFU1NfTU9ERVthc3NldERhdGEuYWRkcmVzc3ZdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYXNzZXREYXRhLmhhc093blByb3BlcnR5KCdtaXBtYXBzJykpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLm1pcG1hcHMgPSBhc3NldERhdGEubWlwbWFwcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGFzc2V0RGF0YS5oYXNPd25Qcm9wZXJ0eSgnYW5pc290cm9weScpKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5hbmlzb3Ryb3B5ID0gYXNzZXREYXRhLmFuaXNvdHJvcHk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhc3NldERhdGEuaGFzT3duUHJvcGVydHkoJ2ZsaXBZJykpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmZsaXBZID0gISFhc3NldERhdGEuZmxpcFk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGV4dHJhY3QgYXNzZXQgdHlwZSAodGhpcyBpcyBiaXQgb2YgYSBtZXNzKVxuICAgICAgICAgICAgaWYgKGFzc2V0RGF0YS5oYXNPd25Qcm9wZXJ0eSgndHlwZScpKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy50eXBlID0gSlNPTl9URVhUVVJFX1RZUEVbYXNzZXREYXRhLnR5cGVdO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChhc3NldERhdGEuaGFzT3duUHJvcGVydHkoJ3JnYm0nKSAmJiBhc3NldERhdGEucmdibSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9IFRFWFRVUkVUWVBFX1JHQk07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGFzc2V0LmZpbGUgJiYgKGFzc2V0LmZpbGUub3B0ICYgOCkgIT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBiYXNpcyBub3JtYWxtYXBzIGZsYWcgdGhlIHZhcmlhbnQgYXMgc3dpenpsZWRcbiAgICAgICAgICAgICAgICBvcHRpb25zLnR5cGUgPSBURVhUVVJFVFlQRV9TV0laWkxFR0dHUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvcHRpb25zO1xuICAgIH1cblxuICAgIGxvYWQodXJsLCBjYWxsYmFjaywgYXNzZXQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB1cmwgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB1cmwgPSB7XG4gICAgICAgICAgICAgICAgbG9hZDogdXJsLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsOiB1cmxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9nZXRQYXJzZXIodXJsLm9yaWdpbmFsKS5sb2FkKHVybCwgY2FsbGJhY2ssIGFzc2V0KTtcbiAgICB9XG5cbiAgICBvcGVuKHVybCwgZGF0YSwgYXNzZXQpIHtcbiAgICAgICAgaWYgKCF1cmwpXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuXG4gICAgICAgIGNvbnN0IHRleHR1cmVPcHRpb25zID0gdGhpcy5fZ2V0VGV4dHVyZU9wdGlvbnMoYXNzZXQpO1xuICAgICAgICBsZXQgdGV4dHVyZSA9IHRoaXMuX2dldFBhcnNlcih1cmwpLm9wZW4odXJsLCBkYXRhLCB0aGlzLl9kZXZpY2UsIHRleHR1cmVPcHRpb25zKTtcblxuICAgICAgICBpZiAodGV4dHVyZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGV4dHVyZSA9IG5ldyBUZXh0dXJlKHRoaXMuX2RldmljZSwge1xuICAgICAgICAgICAgICAgIHdpZHRoOiA0LFxuICAgICAgICAgICAgICAgIGhlaWdodDogNCxcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IFBJWEVMRk9STUFUX1JHQjhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHRleHR1cmUgaGFzIG9ubHkgYSBwYXJ0aWFsIG1pcG1hcCBjaGFpbiBzcGVjaWZpZWQgYW5kIGdlbmVyYXRlIHRoZVxuICAgICAgICAgICAgLy8gbWlzc2luZyBsZXZlbHMgaWYgcG9zc2libGUuXG4gICAgICAgICAgICBfY29tcGxldGVQYXJ0aWFsTWlwbWFwQ2hhaW4odGV4dHVyZSk7XG5cbiAgICAgICAgICAgIC8vIGlmIHRoZSBiYXNpcyB0cmFuc2NvZGVyIHVuc3dpenpsZWQgYSBHR0dSIHRleHR1cmUsIHJlbW92ZSB0aGUgZmxhZyBmcm9tIHRoZSBhc3NldFxuICAgICAgICAgICAgaWYgKGRhdGEudW5zd2l6emxlZEdHR1IpIHtcbiAgICAgICAgICAgICAgICBhc3NldC5maWxlLnZhcmlhbnRzLmJhc2lzLm9wdCAmPSB+ODtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0ZXh0dXJlO1xuICAgIH1cblxuICAgIHBhdGNoKGFzc2V0LCBhc3NldHMpIHtcbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IGFzc2V0LnJlc291cmNlO1xuICAgICAgICBpZiAoIXRleHR1cmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFwcGx5IGFzc2V0IG9wdGlvbnMsIGJhc2VkIG9uIGFzc2V0LmRhdGFcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuX2dldFRleHR1cmVPcHRpb25zKGFzc2V0KTtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMob3B0aW9ucykpIHtcbiAgICAgICAgICAgIHRleHR1cmVba2V5XSA9IG9wdGlvbnNba2V5XTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgVGV4dHVyZUhhbmRsZXIsIFRleHR1cmVQYXJzZXIgfTtcbiJdLCJuYW1lcyI6WyJKU09OX0FERFJFU1NfTU9ERSIsIkFERFJFU1NfUkVQRUFUIiwiQUREUkVTU19DTEFNUF9UT19FREdFIiwiQUREUkVTU19NSVJST1JFRF9SRVBFQVQiLCJKU09OX0ZJTFRFUl9NT0RFIiwiRklMVEVSX05FQVJFU1QiLCJGSUxURVJfTElORUFSIiwiRklMVEVSX05FQVJFU1RfTUlQTUFQX05FQVJFU1QiLCJGSUxURVJfTElORUFSX01JUE1BUF9ORUFSRVNUIiwiRklMVEVSX05FQVJFU1RfTUlQTUFQX0xJTkVBUiIsIkZJTFRFUl9MSU5FQVJfTUlQTUFQX0xJTkVBUiIsIkpTT05fVEVYVFVSRV9UWVBFIiwiVEVYVFVSRVRZUEVfREVGQVVMVCIsIlRFWFRVUkVUWVBFX1JHQk0iLCJURVhUVVJFVFlQRV9SR0JFIiwiVEVYVFVSRVRZUEVfUkdCUCIsIlRFWFRVUkVUWVBFX1NXSVpaTEVHR0dSIiwiVGV4dHVyZVBhcnNlciIsImxvYWQiLCJ1cmwiLCJjYWxsYmFjayIsImFzc2V0IiwiRXJyb3IiLCJvcGVuIiwiZGF0YSIsImRldmljZSIsIl9jb21wbGV0ZVBhcnRpYWxNaXBtYXBDaGFpbiIsInRleHR1cmUiLCJyZXF1aXJlZE1pcExldmVscyIsIk1hdGgiLCJsb2cyIiwibWF4IiwiX3dpZHRoIiwiX2hlaWdodCIsImlzSHRtbEVsZW1lbnQiLCJvYmplY3QiLCJIVE1MQ2FudmFzRWxlbWVudCIsIkhUTUxJbWFnZUVsZW1lbnQiLCJIVE1MVmlkZW9FbGVtZW50IiwiX2Zvcm1hdCIsIlBJWEVMRk9STUFUX1JHQkE4IiwiUElYRUxGT1JNQVRfUkdCQTMyRiIsIl92b2x1bWUiLCJfY29tcHJlc3NlZCIsIl9sZXZlbHMiLCJsZW5ndGgiLCJfY3ViZW1hcCIsImRvd25zYW1wbGUiLCJ3aWR0aCIsImhlaWdodCIsInNhbXBsZWRXaWR0aCIsInNhbXBsZWRIZWlnaHQiLCJzYW1wbGVkRGF0YSIsImNvbnN0cnVjdG9yIiwieHMiLCJmbG9vciIsInlzIiwieHN5cyIsInkiLCJ4IiwiZSIsInN1bSIsInN5Iiwic3giLCJsZXZlbCIsIm1pcHMiLCJmYWNlIiwicHVzaCIsIl9sZXZlbHNVcGRhdGVkIiwiVGV4dHVyZUhhbmRsZXIiLCJhcHAiLCJoYW5kbGVyVHlwZSIsImFzc2V0cyIsImdyYXBoaWNzRGV2aWNlIiwiX2RldmljZSIsIl9hc3NldHMiLCJpbWdQYXJzZXIiLCJJbWdQYXJzZXIiLCJwYXJzZXJzIiwiZGRzIiwiRGRzUGFyc2VyIiwia3R4IiwiS3R4UGFyc2VyIiwia3R4MiIsIkt0eDJQYXJzZXIiLCJiYXNpcyIsIkJhc2lzUGFyc2VyIiwiaGRyIiwiSGRyUGFyc2VyIiwiY3Jvc3NPcmlnaW4iLCJ2YWx1ZSIsIm1heFJldHJpZXMiLCJwYXJzZXIiLCJoYXNPd25Qcm9wZXJ0eSIsIl9nZXRVcmxXaXRob3V0UGFyYW1zIiwiaW5kZXhPZiIsInNwbGl0IiwiX2dldFBhcnNlciIsImV4dCIsInBhdGgiLCJnZXRFeHRlbnNpb24iLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJfZ2V0VGV4dHVyZU9wdGlvbnMiLCJvcHRpb25zIiwicHJvZmlsZXJIaW50IiwiVEVYSElOVF9BU1NFVCIsIl9hc3NldCRuYW1lIiwibmFtZSIsImFzc2V0RGF0YSIsIm1pbkZpbHRlciIsIm1pbmZpbHRlciIsIm1hZ0ZpbHRlciIsIm1hZ2ZpbHRlciIsImFkZHJlc3NVIiwiYWRkcmVzc3UiLCJhZGRyZXNzViIsImFkZHJlc3N2IiwibWlwbWFwcyIsImFuaXNvdHJvcHkiLCJmbGlwWSIsInR5cGUiLCJyZ2JtIiwiZmlsZSIsIm9wdCIsIm9yaWdpbmFsIiwidW5kZWZpbmVkIiwidGV4dHVyZU9wdGlvbnMiLCJUZXh0dXJlIiwiZm9ybWF0IiwiUElYRUxGT1JNQVRfUkdCOCIsInVuc3dpenpsZWRHR0dSIiwidmFyaWFudHMiLCJwYXRjaCIsInJlc291cmNlIiwia2V5IiwiT2JqZWN0Iiwia2V5cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQWtCQTs7QUFFQSxNQUFNQSxpQkFBaUIsR0FBRztBQUN0QixFQUFBLFFBQVEsRUFBRUMsY0FBYztBQUN4QixFQUFBLE9BQU8sRUFBRUMscUJBQXFCO0FBQzlCLEVBQUEsUUFBUSxFQUFFQyx1QkFBQUE7QUFDZCxDQUFDLENBQUE7QUFFRCxNQUFNQyxnQkFBZ0IsR0FBRztBQUNyQixFQUFBLFNBQVMsRUFBRUMsY0FBYztBQUN6QixFQUFBLFFBQVEsRUFBRUMsYUFBYTtBQUN2QixFQUFBLHFCQUFxQixFQUFFQyw2QkFBNkI7QUFDcEQsRUFBQSxvQkFBb0IsRUFBRUMsNEJBQTRCO0FBQ2xELEVBQUEsb0JBQW9CLEVBQUVDLDRCQUE0QjtBQUNsRCxFQUFBLG1CQUFtQixFQUFFQywyQkFBQUE7QUFDekIsQ0FBQyxDQUFBO0FBRUQsTUFBTUMsaUJBQWlCLEdBQUc7QUFDdEIsRUFBQSxTQUFTLEVBQUVDLG1CQUFtQjtBQUM5QixFQUFBLE1BQU0sRUFBRUMsZ0JBQWdCO0FBQ3hCLEVBQUEsTUFBTSxFQUFFQyxnQkFBZ0I7QUFDeEIsRUFBQSxNQUFNLEVBQUVDLGdCQUFnQjtBQUN4QixFQUFBLGFBQWEsRUFBRUMsdUJBQUFBO0FBQ25CLENBQUMsQ0FBQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTUMsYUFBYSxDQUFDO0FBQ2hCO0FBQ0E7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSUMsRUFBQUEsSUFBSUEsQ0FBQ0MsR0FBRyxFQUFFQyxRQUFRLEVBQUVDLEtBQUssRUFBRTtBQUN2QixJQUFBLE1BQU0sSUFBSUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUE7QUFDdEMsR0FBQTs7QUFFQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0lDLEVBQUFBLElBQUlBLENBQUNKLEdBQUcsRUFBRUssSUFBSSxFQUFFQyxNQUFNLEVBQUU7QUFDcEIsSUFBQSxNQUFNLElBQUlILEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxDQUFBO0FBQ3RDLEdBQUE7QUFDQTtBQUNKLENBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTUksMkJBQTJCLEdBQUcsU0FBOUJBLDJCQUEyQkEsQ0FBYUMsT0FBTyxFQUFFO0VBRW5ELE1BQU1DLGlCQUFpQixHQUFHQyxJQUFJLENBQUNDLElBQUksQ0FBQ0QsSUFBSSxDQUFDRSxHQUFHLENBQUNKLE9BQU8sQ0FBQ0ssTUFBTSxFQUFFTCxPQUFPLENBQUNNLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBRWxGLEVBQUEsTUFBTUMsYUFBYSxHQUFHLFNBQWhCQSxhQUFhQSxDQUFhQyxNQUFNLEVBQUU7SUFDcEMsT0FBUUEsTUFBTSxZQUFZQyxpQkFBaUIsSUFDbkNELE1BQU0sWUFBWUUsZ0JBQWlCLElBQ25DRixNQUFNLFlBQVlHLGdCQUFpQixDQUFBO0dBQzlDLENBQUE7QUFFRCxFQUFBLElBQUksRUFBRVgsT0FBTyxDQUFDWSxPQUFPLEtBQUtDLGlCQUFpQixJQUNyQ2IsT0FBTyxDQUFDWSxPQUFPLEtBQUtFLG1CQUFtQixDQUFDLElBQ3hDZCxPQUFPLENBQUNlLE9BQU8sSUFDZmYsT0FBTyxDQUFDZ0IsV0FBVyxJQUNuQmhCLE9BQU8sQ0FBQ2lCLE9BQU8sQ0FBQ0MsTUFBTSxLQUFLLENBQUMsSUFDNUJsQixPQUFPLENBQUNpQixPQUFPLENBQUNDLE1BQU0sS0FBS2pCLGlCQUFpQixJQUM1Q00sYUFBYSxDQUFDUCxPQUFPLENBQUNtQixRQUFRLEdBQUduQixPQUFPLENBQUNpQixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUdqQixPQUFPLENBQUNpQixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtBQUNoRixJQUFBLE9BQUE7QUFDSixHQUFBO0VBRUEsTUFBTUcsVUFBVSxHQUFHLFNBQWJBLFVBQVVBLENBQWFDLEtBQUssRUFBRUMsTUFBTSxFQUFFekIsSUFBSSxFQUFFO0lBQzlDLE1BQU0wQixZQUFZLEdBQUdyQixJQUFJLENBQUNFLEdBQUcsQ0FBQyxDQUFDLEVBQUVpQixLQUFLLElBQUksQ0FBQyxDQUFDLENBQUE7SUFDNUMsTUFBTUcsYUFBYSxHQUFHdEIsSUFBSSxDQUFDRSxHQUFHLENBQUMsQ0FBQyxFQUFFa0IsTUFBTSxJQUFJLENBQUMsQ0FBQyxDQUFBO0FBQzlDLElBQUEsTUFBTUcsV0FBVyxHQUFHLElBQUk1QixJQUFJLENBQUM2QixXQUFXLENBQUNILFlBQVksR0FBR0MsYUFBYSxHQUFHLENBQUMsQ0FBQyxDQUFBO0lBRTFFLE1BQU1HLEVBQUUsR0FBR3pCLElBQUksQ0FBQzBCLEtBQUssQ0FBQ1AsS0FBSyxHQUFHRSxZQUFZLENBQUMsQ0FBQTtJQUMzQyxNQUFNTSxFQUFFLEdBQUczQixJQUFJLENBQUMwQixLQUFLLENBQUNOLE1BQU0sR0FBR0UsYUFBYSxDQUFDLENBQUE7QUFDN0MsSUFBQSxNQUFNTSxJQUFJLEdBQUdILEVBQUUsR0FBR0UsRUFBRSxDQUFBO0lBRXBCLEtBQUssSUFBSUUsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHUCxhQUFhLEVBQUUsRUFBRU8sQ0FBQyxFQUFFO01BQ3BDLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHVCxZQUFZLEVBQUUsRUFBRVMsQ0FBQyxFQUFFO1FBQ25DLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFQSxDQUFDLEVBQUU7VUFDeEIsSUFBSUMsR0FBRyxHQUFHLENBQUMsQ0FBQTtVQUNYLEtBQUssSUFBSUMsRUFBRSxHQUFHLENBQUMsRUFBRUEsRUFBRSxHQUFHTixFQUFFLEVBQUUsRUFBRU0sRUFBRSxFQUFFO1lBQzVCLEtBQUssSUFBSUMsRUFBRSxHQUFHLENBQUMsRUFBRUEsRUFBRSxHQUFHVCxFQUFFLEVBQUUsRUFBRVMsRUFBRSxFQUFFO2NBQzVCRixHQUFHLElBQUlyQyxJQUFJLENBQUMsQ0FBQ21DLENBQUMsR0FBR0wsRUFBRSxHQUFHUyxFQUFFLEdBQUcsQ0FBQ0wsQ0FBQyxHQUFHRixFQUFFLEdBQUdNLEVBQUUsSUFBSWQsS0FBSyxJQUFJLENBQUMsR0FBR1ksQ0FBQyxDQUFDLENBQUE7QUFDOUQsYUFBQTtBQUNKLFdBQUE7QUFDQVIsVUFBQUEsV0FBVyxDQUFDLENBQUNPLENBQUMsR0FBR0QsQ0FBQyxHQUFHUixZQUFZLElBQUksQ0FBQyxHQUFHVSxDQUFDLENBQUMsR0FBR0MsR0FBRyxHQUFHSixJQUFJLENBQUE7QUFDNUQsU0FBQTtBQUNKLE9BQUE7QUFDSixLQUFBO0FBRUEsSUFBQSxPQUFPTCxXQUFXLENBQUE7R0FDckIsQ0FBQTs7QUFFRDtBQUNBLEVBQUEsS0FBSyxJQUFJWSxLQUFLLEdBQUdyQyxPQUFPLENBQUNpQixPQUFPLENBQUNDLE1BQU0sRUFBRW1CLEtBQUssR0FBR3BDLGlCQUFpQixFQUFFLEVBQUVvQyxLQUFLLEVBQUU7QUFDekUsSUFBQSxNQUFNaEIsS0FBSyxHQUFHbkIsSUFBSSxDQUFDRSxHQUFHLENBQUMsQ0FBQyxFQUFFSixPQUFPLENBQUNLLE1BQU0sSUFBS2dDLEtBQUssR0FBRyxDQUFFLENBQUMsQ0FBQTtBQUN4RCxJQUFBLE1BQU1mLE1BQU0sR0FBR3BCLElBQUksQ0FBQ0UsR0FBRyxDQUFDLENBQUMsRUFBRUosT0FBTyxDQUFDTSxPQUFPLElBQUsrQixLQUFLLEdBQUcsQ0FBRSxDQUFDLENBQUE7SUFDMUQsSUFBSXJDLE9BQU8sQ0FBQ21CLFFBQVEsRUFBRTtNQUNsQixNQUFNbUIsSUFBSSxHQUFHLEVBQUUsQ0FBQTtNQUNmLEtBQUssSUFBSUMsSUFBSSxHQUFHLENBQUMsRUFBRUEsSUFBSSxHQUFHLENBQUMsRUFBRSxFQUFFQSxJQUFJLEVBQUU7UUFDakNELElBQUksQ0FBQ0UsSUFBSSxDQUFDcEIsVUFBVSxDQUFDQyxLQUFLLEVBQUVDLE1BQU0sRUFBRXRCLE9BQU8sQ0FBQ2lCLE9BQU8sQ0FBQ29CLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQ0UsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQzFFLE9BQUE7QUFDQXZDLE1BQUFBLE9BQU8sQ0FBQ2lCLE9BQU8sQ0FBQ3VCLElBQUksQ0FBQ0YsSUFBSSxDQUFDLENBQUE7QUFDOUIsS0FBQyxNQUFNO01BQ0h0QyxPQUFPLENBQUNpQixPQUFPLENBQUN1QixJQUFJLENBQUNwQixVQUFVLENBQUNDLEtBQUssRUFBRUMsTUFBTSxFQUFFdEIsT0FBTyxDQUFDaUIsT0FBTyxDQUFDb0IsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUMvRSxLQUFBO0FBQ0osR0FBQTtFQUVBckMsT0FBTyxDQUFDeUMsY0FBYyxHQUFHekMsT0FBTyxDQUFDbUIsUUFBUSxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQTtBQUMvRixDQUFDLENBQUE7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTXVCLGNBQWMsQ0FBQztBQVFqQjtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDSWhCLFdBQVdBLENBQUNpQixHQUFHLEVBQUU7QUFiakI7QUFDSjtBQUNBO0FBQ0E7QUFDQTtJQUpJLElBS0FDLENBQUFBLFdBQVcsR0FBRyxTQUFTLENBQUE7QUFTbkIsSUFBQSxNQUFNQyxNQUFNLEdBQUdGLEdBQUcsQ0FBQ0UsTUFBTSxDQUFBO0FBQ3pCLElBQUEsTUFBTS9DLE1BQU0sR0FBRzZDLEdBQUcsQ0FBQ0csY0FBYyxDQUFBO0lBRWpDLElBQUksQ0FBQ0MsT0FBTyxHQUFHakQsTUFBTSxDQUFBO0lBQ3JCLElBQUksQ0FBQ2tELE9BQU8sR0FBR0gsTUFBTSxDQUFBOztBQUVyQjtBQUNBO0lBQ0EsSUFBSSxDQUFDSSxTQUFTLEdBQUcsSUFBSUMsU0FBUyxDQUFDTCxNQUFNLEVBQUUvQyxNQUFNLENBQUMsQ0FBQTtJQUU5QyxJQUFJLENBQUNxRCxPQUFPLEdBQUc7QUFDWEMsTUFBQUEsR0FBRyxFQUFFLElBQUlDLFNBQVMsQ0FBQ1IsTUFBTSxDQUFDO0FBQzFCUyxNQUFBQSxHQUFHLEVBQUUsSUFBSUMsU0FBUyxDQUFDVixNQUFNLENBQUM7QUFDMUJXLE1BQUFBLElBQUksRUFBRSxJQUFJQyxVQUFVLENBQUNaLE1BQU0sRUFBRS9DLE1BQU0sQ0FBQztBQUNwQzRELE1BQUFBLEtBQUssRUFBRSxJQUFJQyxXQUFXLENBQUNkLE1BQU0sRUFBRS9DLE1BQU0sQ0FBQztBQUN0QzhELE1BQUFBLEdBQUcsRUFBRSxJQUFJQyxTQUFTLENBQUNoQixNQUFNLENBQUE7S0FDNUIsQ0FBQTtBQUNMLEdBQUE7RUFFQSxJQUFJaUIsV0FBV0EsQ0FBQ0MsS0FBSyxFQUFFO0FBQ25CLElBQUEsSUFBSSxDQUFDZCxTQUFTLENBQUNhLFdBQVcsR0FBR0MsS0FBSyxDQUFBO0FBQ3RDLEdBQUE7RUFFQSxJQUFJRCxXQUFXQSxHQUFHO0FBQ2QsSUFBQSxPQUFPLElBQUksQ0FBQ2IsU0FBUyxDQUFDYSxXQUFXLENBQUE7QUFDckMsR0FBQTtFQUVBLElBQUlFLFVBQVVBLENBQUNELEtBQUssRUFBRTtBQUNsQixJQUFBLElBQUksQ0FBQ2QsU0FBUyxDQUFDZSxVQUFVLEdBQUdELEtBQUssQ0FBQTtBQUNqQyxJQUFBLEtBQUssTUFBTUUsTUFBTSxJQUFJLElBQUksQ0FBQ2QsT0FBTyxFQUFFO01BQy9CLElBQUksSUFBSSxDQUFDQSxPQUFPLENBQUNlLGNBQWMsQ0FBQ0QsTUFBTSxDQUFDLEVBQUU7UUFDckMsSUFBSSxDQUFDZCxPQUFPLENBQUNjLE1BQU0sQ0FBQyxDQUFDRCxVQUFVLEdBQUdELEtBQUssQ0FBQTtBQUMzQyxPQUFBO0FBQ0osS0FBQTtBQUNKLEdBQUE7RUFFQSxJQUFJQyxVQUFVQSxHQUFHO0FBQ2IsSUFBQSxPQUFPLElBQUksQ0FBQ2YsU0FBUyxDQUFDZSxVQUFVLENBQUE7QUFDcEMsR0FBQTtFQUVBRyxvQkFBb0JBLENBQUMzRSxHQUFHLEVBQUU7QUFDdEIsSUFBQSxPQUFPQSxHQUFHLENBQUM0RSxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHNUUsR0FBRyxDQUFDNkUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHN0UsR0FBRyxDQUFBO0FBQzFELEdBQUE7RUFFQThFLFVBQVVBLENBQUM5RSxHQUFHLEVBQUU7SUFDWixNQUFNK0UsR0FBRyxHQUFHQyxJQUFJLENBQUNDLFlBQVksQ0FBQyxJQUFJLENBQUNOLG9CQUFvQixDQUFDM0UsR0FBRyxDQUFDLENBQUMsQ0FBQ2tGLFdBQVcsRUFBRSxDQUFDQyxPQUFPLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFBO0lBQzVGLE9BQU8sSUFBSSxDQUFDeEIsT0FBTyxDQUFDb0IsR0FBRyxDQUFDLElBQUksSUFBSSxDQUFDdEIsU0FBUyxDQUFBO0FBQzlDLEdBQUE7RUFFQTJCLGtCQUFrQkEsQ0FBQ2xGLEtBQUssRUFBRTtBQUV0QixJQUFBLE1BQU1tRixPQUFPLEdBQUc7QUFFWkMsTUFBQUEsWUFBWSxFQUFFQyxhQUFBQTtLQUVqQixDQUFBO0FBRUQsSUFBQSxJQUFJckYsS0FBSyxFQUFFO0FBQUEsTUFBQSxJQUFBc0YsV0FBQSxDQUFBO0FBQ1AsTUFBQSxJQUFJLENBQUFBLENBQUFBLFdBQUEsR0FBQXRGLEtBQUssQ0FBQ3VGLElBQUksS0FBVkQsSUFBQUEsR0FBQUEsS0FBQUEsQ0FBQUEsR0FBQUEsV0FBQSxDQUFZOUQsTUFBTSxJQUFHLENBQUMsRUFBRTtBQUN4QjJELFFBQUFBLE9BQU8sQ0FBQ0ksSUFBSSxHQUFHdkYsS0FBSyxDQUFDdUYsSUFBSSxDQUFBO0FBQzdCLE9BQUE7QUFFQSxNQUFBLE1BQU1DLFNBQVMsR0FBR3hGLEtBQUssQ0FBQ0csSUFBSSxDQUFBO0FBRTVCLE1BQUEsSUFBSXFGLFNBQVMsQ0FBQ2hCLGNBQWMsQ0FBQyxXQUFXLENBQUMsRUFBRTtRQUN2Q1csT0FBTyxDQUFDTSxTQUFTLEdBQUcxRyxnQkFBZ0IsQ0FBQ3lHLFNBQVMsQ0FBQ0UsU0FBUyxDQUFDLENBQUE7QUFDN0QsT0FBQTtBQUVBLE1BQUEsSUFBSUYsU0FBUyxDQUFDaEIsY0FBYyxDQUFDLFdBQVcsQ0FBQyxFQUFFO1FBQ3ZDVyxPQUFPLENBQUNRLFNBQVMsR0FBRzVHLGdCQUFnQixDQUFDeUcsU0FBUyxDQUFDSSxTQUFTLENBQUMsQ0FBQTtBQUM3RCxPQUFBO0FBRUEsTUFBQSxJQUFJSixTQUFTLENBQUNoQixjQUFjLENBQUMsVUFBVSxDQUFDLEVBQUU7UUFDdENXLE9BQU8sQ0FBQ1UsUUFBUSxHQUFHbEgsaUJBQWlCLENBQUM2RyxTQUFTLENBQUNNLFFBQVEsQ0FBQyxDQUFBO0FBQzVELE9BQUE7QUFFQSxNQUFBLElBQUlOLFNBQVMsQ0FBQ2hCLGNBQWMsQ0FBQyxVQUFVLENBQUMsRUFBRTtRQUN0Q1csT0FBTyxDQUFDWSxRQUFRLEdBQUdwSCxpQkFBaUIsQ0FBQzZHLFNBQVMsQ0FBQ1EsUUFBUSxDQUFDLENBQUE7QUFDNUQsT0FBQTtBQUVBLE1BQUEsSUFBSVIsU0FBUyxDQUFDaEIsY0FBYyxDQUFDLFNBQVMsQ0FBQyxFQUFFO0FBQ3JDVyxRQUFBQSxPQUFPLENBQUNjLE9BQU8sR0FBR1QsU0FBUyxDQUFDUyxPQUFPLENBQUE7QUFDdkMsT0FBQTtBQUVBLE1BQUEsSUFBSVQsU0FBUyxDQUFDaEIsY0FBYyxDQUFDLFlBQVksQ0FBQyxFQUFFO0FBQ3hDVyxRQUFBQSxPQUFPLENBQUNlLFVBQVUsR0FBR1YsU0FBUyxDQUFDVSxVQUFVLENBQUE7QUFDN0MsT0FBQTtBQUVBLE1BQUEsSUFBSVYsU0FBUyxDQUFDaEIsY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUFFO0FBQ25DVyxRQUFBQSxPQUFPLENBQUNnQixLQUFLLEdBQUcsQ0FBQyxDQUFDWCxTQUFTLENBQUNXLEtBQUssQ0FBQTtBQUNyQyxPQUFBOztBQUVBO0FBQ0EsTUFBQSxJQUFJWCxTQUFTLENBQUNoQixjQUFjLENBQUMsTUFBTSxDQUFDLEVBQUU7UUFDbENXLE9BQU8sQ0FBQ2lCLElBQUksR0FBRzlHLGlCQUFpQixDQUFDa0csU0FBUyxDQUFDWSxJQUFJLENBQUMsQ0FBQTtBQUNwRCxPQUFDLE1BQU0sSUFBSVosU0FBUyxDQUFDaEIsY0FBYyxDQUFDLE1BQU0sQ0FBQyxJQUFJZ0IsU0FBUyxDQUFDYSxJQUFJLEVBQUU7UUFDM0RsQixPQUFPLENBQUNpQixJQUFJLEdBQUc1RyxnQkFBZ0IsQ0FBQTtBQUNuQyxPQUFDLE1BQU0sSUFBSVEsS0FBSyxDQUFDc0csSUFBSSxJQUFJLENBQUN0RyxLQUFLLENBQUNzRyxJQUFJLENBQUNDLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFO0FBQ2pEO1FBQ0FwQixPQUFPLENBQUNpQixJQUFJLEdBQUd6Ryx1QkFBdUIsQ0FBQTtBQUMxQyxPQUFBO0FBQ0osS0FBQTtBQUVBLElBQUEsT0FBT3dGLE9BQU8sQ0FBQTtBQUNsQixHQUFBO0FBRUF0RixFQUFBQSxJQUFJQSxDQUFDQyxHQUFHLEVBQUVDLFFBQVEsRUFBRUMsS0FBSyxFQUFFO0FBQ3ZCLElBQUEsSUFBSSxPQUFPRixHQUFHLEtBQUssUUFBUSxFQUFFO0FBQ3pCQSxNQUFBQSxHQUFHLEdBQUc7QUFDRkQsUUFBQUEsSUFBSSxFQUFFQyxHQUFHO0FBQ1QwRyxRQUFBQSxRQUFRLEVBQUUxRyxHQUFBQTtPQUNiLENBQUE7QUFDTCxLQUFBO0FBRUEsSUFBQSxJQUFJLENBQUM4RSxVQUFVLENBQUM5RSxHQUFHLENBQUMwRyxRQUFRLENBQUMsQ0FBQzNHLElBQUksQ0FBQ0MsR0FBRyxFQUFFQyxRQUFRLEVBQUVDLEtBQUssQ0FBQyxDQUFBO0FBQzVELEdBQUE7QUFFQUUsRUFBQUEsSUFBSUEsQ0FBQ0osR0FBRyxFQUFFSyxJQUFJLEVBQUVILEtBQUssRUFBRTtBQUNuQixJQUFBLElBQUksQ0FBQ0YsR0FBRyxFQUNKLE9BQU8yRyxTQUFTLENBQUE7QUFFcEIsSUFBQSxNQUFNQyxjQUFjLEdBQUcsSUFBSSxDQUFDeEIsa0JBQWtCLENBQUNsRixLQUFLLENBQUMsQ0FBQTtJQUNyRCxJQUFJTSxPQUFPLEdBQUcsSUFBSSxDQUFDc0UsVUFBVSxDQUFDOUUsR0FBRyxDQUFDLENBQUNJLElBQUksQ0FBQ0osR0FBRyxFQUFFSyxJQUFJLEVBQUUsSUFBSSxDQUFDa0QsT0FBTyxFQUFFcUQsY0FBYyxDQUFDLENBQUE7SUFFaEYsSUFBSXBHLE9BQU8sS0FBSyxJQUFJLEVBQUU7QUFDbEJBLE1BQUFBLE9BQU8sR0FBRyxJQUFJcUcsT0FBTyxDQUFDLElBQUksQ0FBQ3RELE9BQU8sRUFBRTtBQUNoQzFCLFFBQUFBLEtBQUssRUFBRSxDQUFDO0FBQ1JDLFFBQUFBLE1BQU0sRUFBRSxDQUFDO0FBQ1RnRixRQUFBQSxNQUFNLEVBQUVDLGdCQUFBQTtBQUNaLE9BQUMsQ0FBQyxDQUFBO0FBQ04sS0FBQyxNQUFNO0FBQ0g7QUFDQTtNQUNBeEcsMkJBQTJCLENBQUNDLE9BQU8sQ0FBQyxDQUFBOztBQUVwQztNQUNBLElBQUlILElBQUksQ0FBQzJHLGNBQWMsRUFBRTtRQUNyQjlHLEtBQUssQ0FBQ3NHLElBQUksQ0FBQ1MsUUFBUSxDQUFDL0MsS0FBSyxDQUFDdUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFBO0FBQ3ZDLE9BQUE7QUFDSixLQUFBO0FBRUEsSUFBQSxPQUFPakcsT0FBTyxDQUFBO0FBQ2xCLEdBQUE7QUFFQTBHLEVBQUFBLEtBQUtBLENBQUNoSCxLQUFLLEVBQUVtRCxNQUFNLEVBQUU7QUFDakIsSUFBQSxNQUFNN0MsT0FBTyxHQUFHTixLQUFLLENBQUNpSCxRQUFRLENBQUE7SUFDOUIsSUFBSSxDQUFDM0csT0FBTyxFQUFFO0FBQ1YsTUFBQSxPQUFBO0FBQ0osS0FBQTs7QUFFQTtBQUNBLElBQUEsTUFBTTZFLE9BQU8sR0FBRyxJQUFJLENBQUNELGtCQUFrQixDQUFDbEYsS0FBSyxDQUFDLENBQUE7SUFDOUMsS0FBSyxNQUFNa0gsR0FBRyxJQUFJQyxNQUFNLENBQUNDLElBQUksQ0FBQ2pDLE9BQU8sQ0FBQyxFQUFFO0FBQ3BDN0UsTUFBQUEsT0FBTyxDQUFDNEcsR0FBRyxDQUFDLEdBQUcvQixPQUFPLENBQUMrQixHQUFHLENBQUMsQ0FBQTtBQUMvQixLQUFBO0FBQ0osR0FBQTtBQUNKOzs7OyJ9
