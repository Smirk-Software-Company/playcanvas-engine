import { Debug } from '../../core/debug.js';
import { EventHandler } from '../../core/event-handler.js';
import { math } from '../../core/math/math.js';
import { Channel } from '../audio/channel.js';
import { Channel3d } from '../audio/channel3d.js';
import { Listener } from './listener.js';

const CONTEXT_STATE_RUNNING = 'running';

/**
 * List of Window events to listen when AudioContext needs to be unlocked.
 */
const USER_INPUT_EVENTS = ['click', 'touchstart', 'mousedown'];

/**
 * The SoundManager is used to load and play audio. It also applies system-wide settings like
 * global volume, suspend and resume.
 *
 * @augments EventHandler
 * @category Sound
 */
class SoundManager extends EventHandler {
  /**
   * Create a new SoundManager instance.
   *
   */
  constructor() {
    super();

    /**
     * The underlying AudioContext, lazy loaded in the 'context' property.
     *
     * @type {AudioContext}
     * @private
     */
    this._context = null;
    this.AudioContext = typeof AudioContext !== 'undefined' && AudioContext || typeof webkitAudioContext !== 'undefined' && webkitAudioContext;
    if (!this.AudioContext) {
      Debug.warn('No support for 3D audio found');
    }
    this._unlockHandlerFunc = this._unlockHandler.bind(this);

    // user suspended audio
    this._userSuspended = false;
    this.listener = new Listener(this);
    this._volume = 1;
  }

  /**
   * Global volume for the manager. All {@link SoundInstance}s will scale their volume with this
   * volume. Valid between [0, 1].
   *
   * @type {number}
   */
  set volume(volume) {
    volume = math.clamp(volume, 0, 1);
    this._volume = volume;
    this.fire('volumechange', volume);
  }
  get volume() {
    return this._volume;
  }
  get suspended() {
    return this._userSuspended;
  }

  /**
   * Get the Web Audio API context.
   *
   * @type {AudioContext}
   * @ignore
   */
  get context() {
    // lazy create the AudioContext
    if (!this._context && this.AudioContext) {
      this._context = new this.AudioContext();
      if (this._context.state !== CONTEXT_STATE_RUNNING) {
        this._registerUnlockListeners();
      }
    }
    return this._context;
  }
  suspend() {
    if (!this._userSuspended) {
      this._userSuspended = true;
      if (this._context && this._context.state === CONTEXT_STATE_RUNNING) {
        this._suspend();
      }
    }
  }
  resume() {
    if (this._userSuspended) {
      this._userSuspended = false;
      if (this._context && this._context.state !== CONTEXT_STATE_RUNNING) {
        this._resume();
      }
    }
  }
  destroy() {
    this.fire('destroy');
    if (this._context) {
      var _this$_context;
      this._removeUnlockListeners();
      (_this$_context = this._context) == null ? void 0 : _this$_context.close();
      this._context = null;
    }
  }

  /**
   * Create a new {@link Channel} and begin playback of the sound.
   *
   * @param {import('./sound.js').Sound} sound - The Sound object to play.
   * @param {object} [options] - Optional options object.
   * @param {number} [options.volume] - The volume to playback at, between 0 and 1.
   * @param {boolean} [options.loop] - Whether to loop the sound when it reaches the end.
   * @returns {Channel} The channel playing the sound.
   * @private
   */
  playSound(sound, options = {}) {
    let channel = null;
    if (Channel) {
      channel = new Channel(this, sound, options);
      channel.play();
    }
    return channel;
  }

  /**
   * Create a new {@link Channel3d} and begin playback of the sound at the position specified.
   *
   * @param {import('./sound.js').Sound} sound - The Sound object to play.
   * @param {import('../../core/math/vec3.js').Vec3} position - The position of the sound in 3D space.
   * @param {object} options - Optional options object.
   * @param {number} [options.volume] - The volume to playback at, between 0 and 1.
   * @param {boolean} [options.loop] - Whether to loop the sound when it reaches the end.
   * @returns {Channel3d} The 3D channel playing the sound.
   * @private
   */
  playSound3d(sound, position, options = {}) {
    let channel = null;
    if (Channel3d) {
      channel = new Channel3d(this, sound, options);
      channel.setPosition(position);
      if (options.volume) {
        channel.setVolume(options.volume);
      }
      if (options.loop) {
        channel.setLoop(options.loop);
      }
      if (options.maxDistance) {
        channel.setMaxDistance(options.maxDistance);
      }
      if (options.minDistance) {
        channel.setMinDistance(options.minDistance);
      }
      if (options.rollOffFactor) {
        channel.setRollOffFactor(options.rollOffFactor);
      }
      if (options.distanceModel) {
        channel.setDistanceModel(options.distanceModel);
      }
      channel.play();
    }
    return channel;
  }

  // resume the sound context
  _resume() {
    this._context.resume().then(() => {
      // Some platforms (mostly iOS) require an additional sound to be played.
      // This also performs a sanity check and verifies sounds can be played.
      const source = this._context.createBufferSource();
      source.buffer = this._context.createBuffer(1, 1, this._context.sampleRate);
      source.connect(this._context.destination);
      source.start(0);

      // onended is only called if everything worked as expected (context is running)
      source.onended = event => {
        source.disconnect(0);
        this.fire('resume');
      };
    }, e => {
      Debug.error(`Attempted to resume the AudioContext on SoundManager.resume(), but it was rejected ${e}`);
    }).catch(e => {
      Debug.error(`Attempted to resume the AudioContext on SoundManager.resume(), but threw an exception ${e}`);
    });
  }

  // resume the sound context and fire suspend event if it succeeds
  _suspend() {
    this._context.suspend().then(() => {
      this.fire('suspend');
    }, e => {
      Debug.error(`Attempted to suspend the AudioContext on SoundManager.suspend(), but it was rejected ${e}`);
    }).catch(e => {
      Debug.error(`Attempted to suspend the AudioContext on SoundManager.suspend(), but threw an exception ${e}`);
    });
  }
  _unlockHandler() {
    this._removeUnlockListeners();
    if (!this._userSuspended && this._context.state !== CONTEXT_STATE_RUNNING) {
      this._resume();
    }
  }
  _registerUnlockListeners() {
    // attach to all user input events
    USER_INPUT_EVENTS.forEach(eventName => {
      window.addEventListener(eventName, this._unlockHandlerFunc, false);
    });
  }
  _removeUnlockListeners() {
    USER_INPUT_EVENTS.forEach(eventName => {
      window.removeEventListener(eventName, this._unlockHandlerFunc, false);
    });
  }
}

export { SoundManager };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFuYWdlci5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL3BsYXRmb3JtL3NvdW5kL21hbmFnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGVidWcgfSBmcm9tICcuLi8uLi9jb3JlL2RlYnVnLmpzJztcblxuaW1wb3J0IHsgRXZlbnRIYW5kbGVyIH0gZnJvbSAnLi4vLi4vY29yZS9ldmVudC1oYW5kbGVyLmpzJztcblxuaW1wb3J0IHsgbWF0aCB9IGZyb20gJy4uLy4uL2NvcmUvbWF0aC9tYXRoLmpzJztcblxuaW1wb3J0IHsgQ2hhbm5lbCB9IGZyb20gJy4uL2F1ZGlvL2NoYW5uZWwuanMnO1xuaW1wb3J0IHsgQ2hhbm5lbDNkIH0gZnJvbSAnLi4vYXVkaW8vY2hhbm5lbDNkLmpzJztcblxuaW1wb3J0IHsgTGlzdGVuZXIgfSBmcm9tICcuL2xpc3RlbmVyLmpzJztcblxuY29uc3QgQ09OVEVYVF9TVEFURV9SVU5OSU5HID0gJ3J1bm5pbmcnO1xuXG4vKipcbiAqIExpc3Qgb2YgV2luZG93IGV2ZW50cyB0byBsaXN0ZW4gd2hlbiBBdWRpb0NvbnRleHQgbmVlZHMgdG8gYmUgdW5sb2NrZWQuXG4gKi9cbmNvbnN0IFVTRVJfSU5QVVRfRVZFTlRTID0gW1xuICAgICdjbGljaycsICd0b3VjaHN0YXJ0JywgJ21vdXNlZG93bidcbl07XG5cbi8qKlxuICogVGhlIFNvdW5kTWFuYWdlciBpcyB1c2VkIHRvIGxvYWQgYW5kIHBsYXkgYXVkaW8uIEl0IGFsc28gYXBwbGllcyBzeXN0ZW0td2lkZSBzZXR0aW5ncyBsaWtlXG4gKiBnbG9iYWwgdm9sdW1lLCBzdXNwZW5kIGFuZCByZXN1bWUuXG4gKlxuICogQGF1Z21lbnRzIEV2ZW50SGFuZGxlclxuICogQGNhdGVnb3J5IFNvdW5kXG4gKi9cbmNsYXNzIFNvdW5kTWFuYWdlciBleHRlbmRzIEV2ZW50SGFuZGxlciB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IFNvdW5kTWFuYWdlciBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdW5kZXJseWluZyBBdWRpb0NvbnRleHQsIGxhenkgbG9hZGVkIGluIHRoZSAnY29udGV4dCcgcHJvcGVydHkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtBdWRpb0NvbnRleHR9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9jb250ZXh0ID0gbnVsbDtcblxuICAgICAgICB0aGlzLkF1ZGlvQ29udGV4dCA9ICh0eXBlb2YgQXVkaW9Db250ZXh0ICE9PSAndW5kZWZpbmVkJyAmJiBBdWRpb0NvbnRleHQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHR5cGVvZiB3ZWJraXRBdWRpb0NvbnRleHQgIT09ICd1bmRlZmluZWQnICYmIHdlYmtpdEF1ZGlvQ29udGV4dCk7XG5cbiAgICAgICAgaWYgKCF0aGlzLkF1ZGlvQ29udGV4dCkge1xuICAgICAgICAgICAgRGVidWcud2FybignTm8gc3VwcG9ydCBmb3IgM0QgYXVkaW8gZm91bmQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3VubG9ja0hhbmRsZXJGdW5jID0gdGhpcy5fdW5sb2NrSGFuZGxlci5iaW5kKHRoaXMpO1xuXG4gICAgICAgIC8vIHVzZXIgc3VzcGVuZGVkIGF1ZGlvXG4gICAgICAgIHRoaXMuX3VzZXJTdXNwZW5kZWQgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLmxpc3RlbmVyID0gbmV3IExpc3RlbmVyKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuX3ZvbHVtZSA9IDE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2xvYmFsIHZvbHVtZSBmb3IgdGhlIG1hbmFnZXIuIEFsbCB7QGxpbmsgU291bmRJbnN0YW5jZX1zIHdpbGwgc2NhbGUgdGhlaXIgdm9sdW1lIHdpdGggdGhpc1xuICAgICAqIHZvbHVtZS4gVmFsaWQgYmV0d2VlbiBbMCwgMV0uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHNldCB2b2x1bWUodm9sdW1lKSB7XG4gICAgICAgIHZvbHVtZSA9IG1hdGguY2xhbXAodm9sdW1lLCAwLCAxKTtcbiAgICAgICAgdGhpcy5fdm9sdW1lID0gdm9sdW1lO1xuICAgICAgICB0aGlzLmZpcmUoJ3ZvbHVtZWNoYW5nZScsIHZvbHVtZSk7XG4gICAgfVxuXG4gICAgZ2V0IHZvbHVtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZvbHVtZTtcbiAgICB9XG5cbiAgICBnZXQgc3VzcGVuZGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXNlclN1c3BlbmRlZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIFdlYiBBdWRpbyBBUEkgY29udGV4dC5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtBdWRpb0NvbnRleHR9XG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIGdldCBjb250ZXh0KCkge1xuICAgICAgICAvLyBsYXp5IGNyZWF0ZSB0aGUgQXVkaW9Db250ZXh0XG4gICAgICAgIGlmICghdGhpcy5fY29udGV4dCAmJiB0aGlzLkF1ZGlvQ29udGV4dCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dCA9IG5ldyB0aGlzLkF1ZGlvQ29udGV4dCgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGV4dC5zdGF0ZSAhPT0gQ09OVEVYVF9TVEFURV9SVU5OSU5HKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVnaXN0ZXJVbmxvY2tMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0O1xuICAgIH1cblxuICAgIHN1c3BlbmQoKSB7XG4gICAgICAgIGlmICghdGhpcy5fdXNlclN1c3BlbmRlZCkge1xuICAgICAgICAgICAgdGhpcy5fdXNlclN1c3BlbmRlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGV4dCAmJiB0aGlzLl9jb250ZXh0LnN0YXRlID09PSBDT05URVhUX1NUQVRFX1JVTk5JTkcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdXNwZW5kKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXN1bWUoKSB7XG4gICAgICAgIGlmICh0aGlzLl91c2VyU3VzcGVuZGVkKSB7XG4gICAgICAgICAgICB0aGlzLl91c2VyU3VzcGVuZGVkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGV4dCAmJiB0aGlzLl9jb250ZXh0LnN0YXRlICE9PSBDT05URVhUX1NUQVRFX1JVTk5JTkcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXN1bWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuZmlyZSgnZGVzdHJveScpO1xuXG4gICAgICAgIGlmICh0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgICAgICB0aGlzLl9yZW1vdmVVbmxvY2tMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQ/LmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyB7QGxpbmsgQ2hhbm5lbH0gYW5kIGJlZ2luIHBsYXliYWNrIG9mIHRoZSBzb3VuZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuL3NvdW5kLmpzJykuU291bmR9IHNvdW5kIC0gVGhlIFNvdW5kIG9iamVjdCB0byBwbGF5LlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBPcHRpb25hbCBvcHRpb25zIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMudm9sdW1lXSAtIFRoZSB2b2x1bWUgdG8gcGxheWJhY2sgYXQsIGJldHdlZW4gMCBhbmQgMS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmxvb3BdIC0gV2hldGhlciB0byBsb29wIHRoZSBzb3VuZCB3aGVuIGl0IHJlYWNoZXMgdGhlIGVuZC5cbiAgICAgKiBAcmV0dXJucyB7Q2hhbm5lbH0gVGhlIGNoYW5uZWwgcGxheWluZyB0aGUgc291bmQuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwbGF5U291bmQoc291bmQsIG9wdGlvbnMgPSB7fSkge1xuICAgICAgICBsZXQgY2hhbm5lbCA9IG51bGw7XG4gICAgICAgIGlmIChDaGFubmVsKSB7XG4gICAgICAgICAgICBjaGFubmVsID0gbmV3IENoYW5uZWwodGhpcywgc291bmQsIG9wdGlvbnMpO1xuICAgICAgICAgICAgY2hhbm5lbC5wbGF5KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoYW5uZWw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IHtAbGluayBDaGFubmVsM2R9IGFuZCBiZWdpbiBwbGF5YmFjayBvZiB0aGUgc291bmQgYXQgdGhlIHBvc2l0aW9uIHNwZWNpZmllZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuL3NvdW5kLmpzJykuU291bmR9IHNvdW5kIC0gVGhlIFNvdW5kIG9iamVjdCB0byBwbGF5LlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuLi8uLi9jb3JlL21hdGgvdmVjMy5qcycpLlZlYzN9IHBvc2l0aW9uIC0gVGhlIHBvc2l0aW9uIG9mIHRoZSBzb3VuZCBpbiAzRCBzcGFjZS5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyAtIE9wdGlvbmFsIG9wdGlvbnMgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy52b2x1bWVdIC0gVGhlIHZvbHVtZSB0byBwbGF5YmFjayBhdCwgYmV0d2VlbiAwIGFuZCAxLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMubG9vcF0gLSBXaGV0aGVyIHRvIGxvb3AgdGhlIHNvdW5kIHdoZW4gaXQgcmVhY2hlcyB0aGUgZW5kLlxuICAgICAqIEByZXR1cm5zIHtDaGFubmVsM2R9IFRoZSAzRCBjaGFubmVsIHBsYXlpbmcgdGhlIHNvdW5kLlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcGxheVNvdW5kM2Qoc291bmQsIHBvc2l0aW9uLCBvcHRpb25zID0ge30pIHtcbiAgICAgICAgbGV0IGNoYW5uZWwgPSBudWxsO1xuICAgICAgICBpZiAoQ2hhbm5lbDNkKSB7XG4gICAgICAgICAgICBjaGFubmVsID0gbmV3IENoYW5uZWwzZCh0aGlzLCBzb3VuZCwgb3B0aW9ucyk7XG4gICAgICAgICAgICBjaGFubmVsLnNldFBvc2l0aW9uKHBvc2l0aW9uKTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnZvbHVtZSkge1xuICAgICAgICAgICAgICAgIGNoYW5uZWwuc2V0Vm9sdW1lKG9wdGlvbnMudm9sdW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmxvb3ApIHtcbiAgICAgICAgICAgICAgICBjaGFubmVsLnNldExvb3Aob3B0aW9ucy5sb29wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLm1heERpc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgY2hhbm5lbC5zZXRNYXhEaXN0YW5jZShvcHRpb25zLm1heERpc3RhbmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLm1pbkRpc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgY2hhbm5lbC5zZXRNaW5EaXN0YW5jZShvcHRpb25zLm1pbkRpc3RhbmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLnJvbGxPZmZGYWN0b3IpIHtcbiAgICAgICAgICAgICAgICBjaGFubmVsLnNldFJvbGxPZmZGYWN0b3Iob3B0aW9ucy5yb2xsT2ZmRmFjdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmRpc3RhbmNlTW9kZWwpIHtcbiAgICAgICAgICAgICAgICBjaGFubmVsLnNldERpc3RhbmNlTW9kZWwob3B0aW9ucy5kaXN0YW5jZU1vZGVsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2hhbm5lbC5wbGF5KCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY2hhbm5lbDtcbiAgICB9XG5cbiAgICAvLyByZXN1bWUgdGhlIHNvdW5kIGNvbnRleHRcbiAgICBfcmVzdW1lKCkge1xuICAgICAgICB0aGlzLl9jb250ZXh0LnJlc3VtZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gU29tZSBwbGF0Zm9ybXMgKG1vc3RseSBpT1MpIHJlcXVpcmUgYW4gYWRkaXRpb25hbCBzb3VuZCB0byBiZSBwbGF5ZWQuXG4gICAgICAgICAgICAvLyBUaGlzIGFsc28gcGVyZm9ybXMgYSBzYW5pdHkgY2hlY2sgYW5kIHZlcmlmaWVzIHNvdW5kcyBjYW4gYmUgcGxheWVkLlxuICAgICAgICAgICAgY29uc3Qgc291cmNlID0gdGhpcy5fY29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcbiAgICAgICAgICAgIHNvdXJjZS5idWZmZXIgPSB0aGlzLl9jb250ZXh0LmNyZWF0ZUJ1ZmZlcigxLCAxLCB0aGlzLl9jb250ZXh0LnNhbXBsZVJhdGUpO1xuICAgICAgICAgICAgc291cmNlLmNvbm5lY3QodGhpcy5fY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICBzb3VyY2Uuc3RhcnQoMCk7XG5cbiAgICAgICAgICAgIC8vIG9uZW5kZWQgaXMgb25seSBjYWxsZWQgaWYgZXZlcnl0aGluZyB3b3JrZWQgYXMgZXhwZWN0ZWQgKGNvbnRleHQgaXMgcnVubmluZylcbiAgICAgICAgICAgIHNvdXJjZS5vbmVuZGVkID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgc291cmNlLmRpc2Nvbm5lY3QoMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKCdyZXN1bWUnKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sIChlKSA9PiB7XG4gICAgICAgICAgICBEZWJ1Zy5lcnJvcihgQXR0ZW1wdGVkIHRvIHJlc3VtZSB0aGUgQXVkaW9Db250ZXh0IG9uIFNvdW5kTWFuYWdlci5yZXN1bWUoKSwgYnV0IGl0IHdhcyByZWplY3RlZCAke2V9YCk7XG4gICAgICAgIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgICBEZWJ1Zy5lcnJvcihgQXR0ZW1wdGVkIHRvIHJlc3VtZSB0aGUgQXVkaW9Db250ZXh0IG9uIFNvdW5kTWFuYWdlci5yZXN1bWUoKSwgYnV0IHRocmV3IGFuIGV4Y2VwdGlvbiAke2V9YCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIHJlc3VtZSB0aGUgc291bmQgY29udGV4dCBhbmQgZmlyZSBzdXNwZW5kIGV2ZW50IGlmIGl0IHN1Y2NlZWRzXG4gICAgX3N1c3BlbmQoKSB7XG4gICAgICAgIHRoaXMuX2NvbnRleHQuc3VzcGVuZCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maXJlKCdzdXNwZW5kJyk7XG4gICAgICAgIH0sIChlKSA9PiB7XG4gICAgICAgICAgICBEZWJ1Zy5lcnJvcihgQXR0ZW1wdGVkIHRvIHN1c3BlbmQgdGhlIEF1ZGlvQ29udGV4dCBvbiBTb3VuZE1hbmFnZXIuc3VzcGVuZCgpLCBidXQgaXQgd2FzIHJlamVjdGVkICR7ZX1gKTtcbiAgICAgICAgfSkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgICAgIERlYnVnLmVycm9yKGBBdHRlbXB0ZWQgdG8gc3VzcGVuZCB0aGUgQXVkaW9Db250ZXh0IG9uIFNvdW5kTWFuYWdlci5zdXNwZW5kKCksIGJ1dCB0aHJldyBhbiBleGNlcHRpb24gJHtlfWApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfdW5sb2NrSGFuZGxlcigpIHtcbiAgICAgICAgdGhpcy5fcmVtb3ZlVW5sb2NrTGlzdGVuZXJzKCk7XG5cbiAgICAgICAgaWYgKCF0aGlzLl91c2VyU3VzcGVuZGVkICYmIHRoaXMuX2NvbnRleHQuc3RhdGUgIT09IENPTlRFWFRfU1RBVEVfUlVOTklORykge1xuICAgICAgICAgICAgdGhpcy5fcmVzdW1lKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfcmVnaXN0ZXJVbmxvY2tMaXN0ZW5lcnMoKSB7XG4gICAgICAgIC8vIGF0dGFjaCB0byBhbGwgdXNlciBpbnB1dCBldmVudHNcbiAgICAgICAgVVNFUl9JTlBVVF9FVkVOVFMuZm9yRWFjaCgoZXZlbnROYW1lKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIHRoaXMuX3VubG9ja0hhbmRsZXJGdW5jLCBmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9yZW1vdmVVbmxvY2tMaXN0ZW5lcnMoKSB7XG4gICAgICAgIFVTRVJfSU5QVVRfRVZFTlRTLmZvckVhY2goKGV2ZW50TmFtZSkgPT4ge1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCB0aGlzLl91bmxvY2tIYW5kbGVyRnVuYywgZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IFNvdW5kTWFuYWdlciB9O1xuIl0sIm5hbWVzIjpbIkNPTlRFWFRfU1RBVEVfUlVOTklORyIsIlVTRVJfSU5QVVRfRVZFTlRTIiwiU291bmRNYW5hZ2VyIiwiRXZlbnRIYW5kbGVyIiwiY29uc3RydWN0b3IiLCJfY29udGV4dCIsIkF1ZGlvQ29udGV4dCIsIndlYmtpdEF1ZGlvQ29udGV4dCIsIkRlYnVnIiwid2FybiIsIl91bmxvY2tIYW5kbGVyRnVuYyIsIl91bmxvY2tIYW5kbGVyIiwiYmluZCIsIl91c2VyU3VzcGVuZGVkIiwibGlzdGVuZXIiLCJMaXN0ZW5lciIsIl92b2x1bWUiLCJ2b2x1bWUiLCJtYXRoIiwiY2xhbXAiLCJmaXJlIiwic3VzcGVuZGVkIiwiY29udGV4dCIsInN0YXRlIiwiX3JlZ2lzdGVyVW5sb2NrTGlzdGVuZXJzIiwic3VzcGVuZCIsIl9zdXNwZW5kIiwicmVzdW1lIiwiX3Jlc3VtZSIsImRlc3Ryb3kiLCJfdGhpcyRfY29udGV4dCIsIl9yZW1vdmVVbmxvY2tMaXN0ZW5lcnMiLCJjbG9zZSIsInBsYXlTb3VuZCIsInNvdW5kIiwib3B0aW9ucyIsImNoYW5uZWwiLCJDaGFubmVsIiwicGxheSIsInBsYXlTb3VuZDNkIiwicG9zaXRpb24iLCJDaGFubmVsM2QiLCJzZXRQb3NpdGlvbiIsInNldFZvbHVtZSIsImxvb3AiLCJzZXRMb29wIiwibWF4RGlzdGFuY2UiLCJzZXRNYXhEaXN0YW5jZSIsIm1pbkRpc3RhbmNlIiwic2V0TWluRGlzdGFuY2UiLCJyb2xsT2ZmRmFjdG9yIiwic2V0Um9sbE9mZkZhY3RvciIsImRpc3RhbmNlTW9kZWwiLCJzZXREaXN0YW5jZU1vZGVsIiwidGhlbiIsInNvdXJjZSIsImNyZWF0ZUJ1ZmZlclNvdXJjZSIsImJ1ZmZlciIsImNyZWF0ZUJ1ZmZlciIsInNhbXBsZVJhdGUiLCJjb25uZWN0IiwiZGVzdGluYXRpb24iLCJzdGFydCIsIm9uZW5kZWQiLCJldmVudCIsImRpc2Nvbm5lY3QiLCJlIiwiZXJyb3IiLCJjYXRjaCIsImZvckVhY2giLCJldmVudE5hbWUiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQVdBLE1BQU1BLHFCQUFxQixHQUFHLFNBQVMsQ0FBQTs7QUFFdkM7QUFDQTtBQUNBO0FBQ0EsTUFBTUMsaUJBQWlCLEdBQUcsQ0FDdEIsT0FBTyxFQUFFLFlBQVksRUFBRSxXQUFXLENBQ3JDLENBQUE7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNQyxZQUFZLFNBQVNDLFlBQVksQ0FBQztBQUNwQztBQUNKO0FBQ0E7QUFDQTtBQUNJQyxFQUFBQSxXQUFXQSxHQUFHO0FBQ1YsSUFBQSxLQUFLLEVBQUUsQ0FBQTs7QUFFUDtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7SUFDUSxJQUFJLENBQUNDLFFBQVEsR0FBRyxJQUFJLENBQUE7QUFFcEIsSUFBQSxJQUFJLENBQUNDLFlBQVksR0FBSSxPQUFPQSxZQUFZLEtBQUssV0FBVyxJQUFJQSxZQUFZLElBQ25ELE9BQU9DLGtCQUFrQixLQUFLLFdBQVcsSUFBSUEsa0JBQW1CLENBQUE7QUFFckYsSUFBQSxJQUFJLENBQUMsSUFBSSxDQUFDRCxZQUFZLEVBQUU7QUFDcEJFLE1BQUFBLEtBQUssQ0FBQ0MsSUFBSSxDQUFDLCtCQUErQixDQUFDLENBQUE7QUFDL0MsS0FBQTtJQUVBLElBQUksQ0FBQ0Msa0JBQWtCLEdBQUcsSUFBSSxDQUFDQyxjQUFjLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTs7QUFFeEQ7SUFDQSxJQUFJLENBQUNDLGNBQWMsR0FBRyxLQUFLLENBQUE7QUFFM0IsSUFBQSxJQUFJLENBQUNDLFFBQVEsR0FBRyxJQUFJQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUE7SUFFbEMsSUFBSSxDQUFDQyxPQUFPLEdBQUcsQ0FBQyxDQUFBO0FBQ3BCLEdBQUE7O0FBRUE7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0ksSUFBSUMsTUFBTUEsQ0FBQ0EsTUFBTSxFQUFFO0lBQ2ZBLE1BQU0sR0FBR0MsSUFBSSxDQUFDQyxLQUFLLENBQUNGLE1BQU0sRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7SUFDakMsSUFBSSxDQUFDRCxPQUFPLEdBQUdDLE1BQU0sQ0FBQTtBQUNyQixJQUFBLElBQUksQ0FBQ0csSUFBSSxDQUFDLGNBQWMsRUFBRUgsTUFBTSxDQUFDLENBQUE7QUFDckMsR0FBQTtFQUVBLElBQUlBLE1BQU1BLEdBQUc7SUFDVCxPQUFPLElBQUksQ0FBQ0QsT0FBTyxDQUFBO0FBQ3ZCLEdBQUE7RUFFQSxJQUFJSyxTQUFTQSxHQUFHO0lBQ1osT0FBTyxJQUFJLENBQUNSLGNBQWMsQ0FBQTtBQUM5QixHQUFBOztBQUVBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNJLElBQUlTLE9BQU9BLEdBQUc7QUFDVjtJQUNBLElBQUksQ0FBQyxJQUFJLENBQUNqQixRQUFRLElBQUksSUFBSSxDQUFDQyxZQUFZLEVBQUU7TUFDckMsSUFBSSxDQUFDRCxRQUFRLEdBQUcsSUFBSSxJQUFJLENBQUNDLFlBQVksRUFBRSxDQUFBO0FBRXZDLE1BQUEsSUFBSSxJQUFJLENBQUNELFFBQVEsQ0FBQ2tCLEtBQUssS0FBS3ZCLHFCQUFxQixFQUFFO1FBQy9DLElBQUksQ0FBQ3dCLHdCQUF3QixFQUFFLENBQUE7QUFDbkMsT0FBQTtBQUNKLEtBQUE7SUFFQSxPQUFPLElBQUksQ0FBQ25CLFFBQVEsQ0FBQTtBQUN4QixHQUFBO0FBRUFvQixFQUFBQSxPQUFPQSxHQUFHO0FBQ04sSUFBQSxJQUFJLENBQUMsSUFBSSxDQUFDWixjQUFjLEVBQUU7TUFDdEIsSUFBSSxDQUFDQSxjQUFjLEdBQUcsSUFBSSxDQUFBO01BQzFCLElBQUksSUFBSSxDQUFDUixRQUFRLElBQUksSUFBSSxDQUFDQSxRQUFRLENBQUNrQixLQUFLLEtBQUt2QixxQkFBcUIsRUFBRTtRQUNoRSxJQUFJLENBQUMwQixRQUFRLEVBQUUsQ0FBQTtBQUNuQixPQUFBO0FBQ0osS0FBQTtBQUNKLEdBQUE7QUFFQUMsRUFBQUEsTUFBTUEsR0FBRztJQUNMLElBQUksSUFBSSxDQUFDZCxjQUFjLEVBQUU7TUFDckIsSUFBSSxDQUFDQSxjQUFjLEdBQUcsS0FBSyxDQUFBO01BQzNCLElBQUksSUFBSSxDQUFDUixRQUFRLElBQUksSUFBSSxDQUFDQSxRQUFRLENBQUNrQixLQUFLLEtBQUt2QixxQkFBcUIsRUFBRTtRQUNoRSxJQUFJLENBQUM0QixPQUFPLEVBQUUsQ0FBQTtBQUNsQixPQUFBO0FBQ0osS0FBQTtBQUNKLEdBQUE7QUFFQUMsRUFBQUEsT0FBT0EsR0FBRztBQUNOLElBQUEsSUFBSSxDQUFDVCxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUE7SUFFcEIsSUFBSSxJQUFJLENBQUNmLFFBQVEsRUFBRTtBQUFBLE1BQUEsSUFBQXlCLGNBQUEsQ0FBQTtNQUNmLElBQUksQ0FBQ0Msc0JBQXNCLEVBQUUsQ0FBQTtNQUM3QixDQUFBRCxjQUFBLE9BQUksQ0FBQ3pCLFFBQVEscUJBQWJ5QixjQUFBLENBQWVFLEtBQUssRUFBRSxDQUFBO01BQ3RCLElBQUksQ0FBQzNCLFFBQVEsR0FBRyxJQUFJLENBQUE7QUFDeEIsS0FBQTtBQUNKLEdBQUE7O0FBRUE7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTRCLEVBQUFBLFNBQVNBLENBQUNDLEtBQUssRUFBRUMsT0FBTyxHQUFHLEVBQUUsRUFBRTtJQUMzQixJQUFJQyxPQUFPLEdBQUcsSUFBSSxDQUFBO0FBQ2xCLElBQUEsSUFBSUMsT0FBTyxFQUFFO01BQ1RELE9BQU8sR0FBRyxJQUFJQyxPQUFPLENBQUMsSUFBSSxFQUFFSCxLQUFLLEVBQUVDLE9BQU8sQ0FBQyxDQUFBO01BQzNDQyxPQUFPLENBQUNFLElBQUksRUFBRSxDQUFBO0FBQ2xCLEtBQUE7QUFDQSxJQUFBLE9BQU9GLE9BQU8sQ0FBQTtBQUNsQixHQUFBOztBQUVBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDSUcsV0FBV0EsQ0FBQ0wsS0FBSyxFQUFFTSxRQUFRLEVBQUVMLE9BQU8sR0FBRyxFQUFFLEVBQUU7SUFDdkMsSUFBSUMsT0FBTyxHQUFHLElBQUksQ0FBQTtBQUNsQixJQUFBLElBQUlLLFNBQVMsRUFBRTtNQUNYTCxPQUFPLEdBQUcsSUFBSUssU0FBUyxDQUFDLElBQUksRUFBRVAsS0FBSyxFQUFFQyxPQUFPLENBQUMsQ0FBQTtBQUM3Q0MsTUFBQUEsT0FBTyxDQUFDTSxXQUFXLENBQUNGLFFBQVEsQ0FBQyxDQUFBO01BQzdCLElBQUlMLE9BQU8sQ0FBQ2xCLE1BQU0sRUFBRTtBQUNoQm1CLFFBQUFBLE9BQU8sQ0FBQ08sU0FBUyxDQUFDUixPQUFPLENBQUNsQixNQUFNLENBQUMsQ0FBQTtBQUNyQyxPQUFBO01BQ0EsSUFBSWtCLE9BQU8sQ0FBQ1MsSUFBSSxFQUFFO0FBQ2RSLFFBQUFBLE9BQU8sQ0FBQ1MsT0FBTyxDQUFDVixPQUFPLENBQUNTLElBQUksQ0FBQyxDQUFBO0FBQ2pDLE9BQUE7TUFDQSxJQUFJVCxPQUFPLENBQUNXLFdBQVcsRUFBRTtBQUNyQlYsUUFBQUEsT0FBTyxDQUFDVyxjQUFjLENBQUNaLE9BQU8sQ0FBQ1csV0FBVyxDQUFDLENBQUE7QUFDL0MsT0FBQTtNQUNBLElBQUlYLE9BQU8sQ0FBQ2EsV0FBVyxFQUFFO0FBQ3JCWixRQUFBQSxPQUFPLENBQUNhLGNBQWMsQ0FBQ2QsT0FBTyxDQUFDYSxXQUFXLENBQUMsQ0FBQTtBQUMvQyxPQUFBO01BQ0EsSUFBSWIsT0FBTyxDQUFDZSxhQUFhLEVBQUU7QUFDdkJkLFFBQUFBLE9BQU8sQ0FBQ2UsZ0JBQWdCLENBQUNoQixPQUFPLENBQUNlLGFBQWEsQ0FBQyxDQUFBO0FBQ25ELE9BQUE7TUFDQSxJQUFJZixPQUFPLENBQUNpQixhQUFhLEVBQUU7QUFDdkJoQixRQUFBQSxPQUFPLENBQUNpQixnQkFBZ0IsQ0FBQ2xCLE9BQU8sQ0FBQ2lCLGFBQWEsQ0FBQyxDQUFBO0FBQ25ELE9BQUE7TUFFQWhCLE9BQU8sQ0FBQ0UsSUFBSSxFQUFFLENBQUE7QUFDbEIsS0FBQTtBQUVBLElBQUEsT0FBT0YsT0FBTyxDQUFBO0FBQ2xCLEdBQUE7O0FBRUE7QUFDQVIsRUFBQUEsT0FBT0EsR0FBRztJQUNOLElBQUksQ0FBQ3ZCLFFBQVEsQ0FBQ3NCLE1BQU0sRUFBRSxDQUFDMkIsSUFBSSxDQUFDLE1BQU07QUFDOUI7QUFDQTtNQUNBLE1BQU1DLE1BQU0sR0FBRyxJQUFJLENBQUNsRCxRQUFRLENBQUNtRCxrQkFBa0IsRUFBRSxDQUFBO0FBQ2pERCxNQUFBQSxNQUFNLENBQUNFLE1BQU0sR0FBRyxJQUFJLENBQUNwRCxRQUFRLENBQUNxRCxZQUFZLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUNyRCxRQUFRLENBQUNzRCxVQUFVLENBQUMsQ0FBQTtNQUMxRUosTUFBTSxDQUFDSyxPQUFPLENBQUMsSUFBSSxDQUFDdkQsUUFBUSxDQUFDd0QsV0FBVyxDQUFDLENBQUE7QUFDekNOLE1BQUFBLE1BQU0sQ0FBQ08sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFBOztBQUVmO0FBQ0FQLE1BQUFBLE1BQU0sQ0FBQ1EsT0FBTyxHQUFJQyxLQUFLLElBQUs7QUFDeEJULFFBQUFBLE1BQU0sQ0FBQ1UsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3BCLFFBQUEsSUFBSSxDQUFDN0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFBO09BQ3RCLENBQUE7S0FDSixFQUFHOEMsQ0FBQyxJQUFLO0FBQ04xRCxNQUFBQSxLQUFLLENBQUMyRCxLQUFLLENBQUUsQ0FBcUZELG1GQUFBQSxFQUFBQSxDQUFFLEVBQUMsQ0FBQyxDQUFBO0FBQzFHLEtBQUMsQ0FBQyxDQUFDRSxLQUFLLENBQUVGLENBQUMsSUFBSztBQUNaMUQsTUFBQUEsS0FBSyxDQUFDMkQsS0FBSyxDQUFFLENBQXdGRCxzRkFBQUEsRUFBQUEsQ0FBRSxFQUFDLENBQUMsQ0FBQTtBQUM3RyxLQUFDLENBQUMsQ0FBQTtBQUNOLEdBQUE7O0FBRUE7QUFDQXhDLEVBQUFBLFFBQVFBLEdBQUc7SUFDUCxJQUFJLENBQUNyQixRQUFRLENBQUNvQixPQUFPLEVBQUUsQ0FBQzZCLElBQUksQ0FBQyxNQUFNO0FBQy9CLE1BQUEsSUFBSSxDQUFDbEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFBO0tBQ3ZCLEVBQUc4QyxDQUFDLElBQUs7QUFDTjFELE1BQUFBLEtBQUssQ0FBQzJELEtBQUssQ0FBRSxDQUF1RkQscUZBQUFBLEVBQUFBLENBQUUsRUFBQyxDQUFDLENBQUE7QUFDNUcsS0FBQyxDQUFDLENBQUNFLEtBQUssQ0FBRUYsQ0FBQyxJQUFLO0FBQ1oxRCxNQUFBQSxLQUFLLENBQUMyRCxLQUFLLENBQUUsQ0FBMEZELHdGQUFBQSxFQUFBQSxDQUFFLEVBQUMsQ0FBQyxDQUFBO0FBQy9HLEtBQUMsQ0FBQyxDQUFBO0FBQ04sR0FBQTtBQUVBdkQsRUFBQUEsY0FBY0EsR0FBRztJQUNiLElBQUksQ0FBQ29CLHNCQUFzQixFQUFFLENBQUE7QUFFN0IsSUFBQSxJQUFJLENBQUMsSUFBSSxDQUFDbEIsY0FBYyxJQUFJLElBQUksQ0FBQ1IsUUFBUSxDQUFDa0IsS0FBSyxLQUFLdkIscUJBQXFCLEVBQUU7TUFDdkUsSUFBSSxDQUFDNEIsT0FBTyxFQUFFLENBQUE7QUFDbEIsS0FBQTtBQUNKLEdBQUE7QUFFQUosRUFBQUEsd0JBQXdCQSxHQUFHO0FBQ3ZCO0FBQ0F2QixJQUFBQSxpQkFBaUIsQ0FBQ29FLE9BQU8sQ0FBRUMsU0FBUyxJQUFLO01BQ3JDQyxNQUFNLENBQUNDLGdCQUFnQixDQUFDRixTQUFTLEVBQUUsSUFBSSxDQUFDNUQsa0JBQWtCLEVBQUUsS0FBSyxDQUFDLENBQUE7QUFDdEUsS0FBQyxDQUFDLENBQUE7QUFDTixHQUFBO0FBRUFxQixFQUFBQSxzQkFBc0JBLEdBQUc7QUFDckI5QixJQUFBQSxpQkFBaUIsQ0FBQ29FLE9BQU8sQ0FBRUMsU0FBUyxJQUFLO01BQ3JDQyxNQUFNLENBQUNFLG1CQUFtQixDQUFDSCxTQUFTLEVBQUUsSUFBSSxDQUFDNUQsa0JBQWtCLEVBQUUsS0FBSyxDQUFDLENBQUE7QUFDekUsS0FBQyxDQUFDLENBQUE7QUFDTixHQUFBO0FBQ0o7Ozs7In0=
